/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CineVaultPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/constants.ts
var VIEW_TYPE = "BoxOfficeView";
var FOLDER = "BoxOffice";
var JSON_NAME = "boxoffice";
var OMDB_TYPES = ["movie", "series", "episode"];

// src/views/pluginView.ts
var import_obsidian5 = require("obsidian");

// src/ui/onboarding.ts
function renderOnboarding(container, onCreate, onLink) {
  const onboarding = container.createDiv({
    cls: "obs-plugin-onboarding"
  });
  const actions = onboarding.createDiv({ cls: "obs-plugin-onboarding-actions" });
  const createButton = actions.createEl("button", { text: "Create new library" });
  createButton.addEventListener("click", onCreate);
  if (onLink) {
    actions.createEl("p", { text: "or" });
    const linkButton = actions.createEl("button", { text: "Link existing library" });
    linkButton.addEventListener("click", onLink);
  }
}

// src/ui/modals/actionModal.ts
var import_obsidian = require("obsidian");
var CineVaultMovieActionModal = class extends import_obsidian.Modal {
  constructor(app, movie, onSave) {
    super(app);
    this.movie = movie;
    this.onSave = onSave;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.movie.title });
    contentEl.createEl("p", { text: `${this.movie.year} \u2022 ${this.movie.type}` });
    if (this.movie.poster) {
      contentEl.createEl("img", { cls: "obs-plugin-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    contentEl.createEl("p", { text: this.movie.plot });
    const actions = contentEl.createDiv({ cls: "obs-plugin-modal-detail-actions" });
    const watchedButton = actions.createEl("button", { text: "Mark as watched" });
    const toWatchButton = actions.createEl("button", { text: "To watch" });
    watchedButton.addEventListener("click", () => {
      this.onSave(true);
      this.close();
    });
    toWatchButton.addEventListener("click", () => {
      this.onSave(false);
      this.close();
    });
  }
};

// src/ui/modals/detailModal.ts
var import_obsidian2 = require("obsidian");

// src/ui/starRating.ts
function createStarRating(container, rating, readOnly, onChange) {
  const stars = container.createDiv({ cls: "obs-plugin-stars" });
  const starElements = [];
  let currentRating = rating;
  for (let i = 1; i <= 5; i += 1) {
    const star = stars.createEl("span", { text: "\u2605", cls: "obs-plugin-star" });
    if (i <= rating)
      star.classList.add("active");
    starElements.push(star);
    if (!readOnly) {
      star.addEventListener("click", () => {
        if (currentRating === i) {
          currentRating = 0;
          starElements.forEach((element) => {
            element.classList.remove("active");
          });
        } else {
          currentRating = i;
          starElements.forEach((element, index) => {
            element.classList.toggle("active", index < i);
          });
        }
        onChange == null ? void 0 : onChange(currentRating);
      });
    } else {
      star.classList.add("readonly");
    }
  }
  return stars;
}

// src/utils/globalMethods.ts
function nullSafe(func, fallbackValue = null) {
  try {
    const value = func();
    return value === null || value === void 0 ? fallbackValue : value;
  } catch (e) {
    console.error("Error: ", e);
    return fallbackValue;
  }
}
function formatRating(rating) {
  let value = rating;
  const isPerTen = rating.includes("/10");
  const isPerCent = rating.includes("/100");
  if (isPerTen && !isPerCent) {
    const normalized = value.replace(",", ".");
    const num = parseFloat(normalized);
    if (!isNaN(num) && isFinite(num)) {
      const multiplied = num * 10;
      value = multiplied % 1 === 0 ? String(Math.trunc(multiplied)) : String(multiplied);
    }
  } else if (rating.includes("/") && isPerCent) {
    value = rating.split("/")[0].trim();
  } else if (rating.includes("%")) {
    value = rating.replace("%", "").trim();
  }
  return value;
}
function averageRating(ratings) {
  const normalizedRatings = ratings.map(formatRating).map((r) => parseFloat(r)).filter((r) => !isNaN(r) && isFinite(r));
  if (normalizedRatings.length === 0)
    return "N/A";
  const sum = normalizedRatings.reduce((acc, val) => acc + val, 0);
  const average = sum / normalizedRatings.length;
  return average % 1 === 0 ? String(Math.trunc(average)) : String(average.toFixed(1));
}
function renderExternalRatingBar(parent, ratings, options) {
  if (!ratings || ratings.length === 0)
    return null;
  const ratingBarContainer = parent.createDiv({ cls: "plugin-ratings-bar-container" });
  const ratingBar = ratingBarContainer.createDiv({ cls: "plugin-ratings-bar" });
  const ratingFill = ratingBar.createDiv({ cls: "plugin-ratings-fill" });
  const values = ratings.map((r) => formatRating(r.Value));
  const average = averageRating(values);
  const percentage = parseFloat(average);
  ratingFill.style.width = `${isNaN(percentage) ? 0 : percentage}%`;
  ratingBarContainer.createEl("span", {
    text: `${average}%`,
    cls: "plugin-ratings-average"
  });
  return {
    container: ratingBarContainer,
    average,
    percentage: isNaN(percentage) ? 0 : percentage
  };
}

// src/ui/modals/detailModal.ts
var CineVaultMovieDetailModal = class extends import_obsidian2.Modal {
  constructor(app, movie, onRate, onRemove, onToggleWatched) {
    super(app);
    this.movie = movie;
    this.onRate = onRate;
    this.onRemove = onRemove;
    this.onToggleWatched = onToggleWatched;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const modalContainer = contentEl.createDiv({
      cls: "obs-plugin-modal-detail-container"
    });
    const modalHeader = modalContainer.createDiv({
      cls: "obs-plugin-modal-detail-header"
    });
    const modalTitleContainer = modalHeader.createDiv({
      cls: "obs-plugin-modal-detail-title-container"
    });
    modalTitleContainer.createEl("h1", {
      text: this.movie.title,
      cls: "obs-plugin-modal-detail-title"
    });
    const type = nullSafe(() => this.movie.type[0].toUpperCase() + this.movie.type.slice(1), null);
    const year = nullSafe(() => this.movie.year, null);
    modalTitleContainer.createEl("p", {
      text: `${year} - ${type}`
    });
    modalTitleContainer.createEl("p", {
      text: "Directed by " + nullSafe(() => this.movie.director, "N/A")
    });
    modalTitleContainer.createEl("p", {
      text: "Duration " + nullSafe(() => this.movie.runtime, "N/A")
    });
    if (this.movie.poster) {
      modalHeader.createEl("img", { cls: "obs-plugin-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    if (this.movie.plot) {
      const plotContainer = modalContainer.createEl("div", { cls: "obs-plugin-modal-detail-plot-container" });
      const plotEl = plotContainer.createEl("p", {
        text: this.movie.plot,
        cls: "obs-plugin-modal-detail-plot"
      });
      const showMoreButton = plotContainer.createEl("button", {
        text: "Show more",
        cls: "obs-plugin-modal-detail-show-more obs-plugin-modal-detail-show-more-hidden"
      });
      showMoreButton.addEventListener("click", () => {
        const isExpanded = plotEl.classList.toggle("expanded-plot");
        showMoreButton.setText(isExpanded ? "Show less" : "Show more");
      });
      requestAnimationFrame(() => {
        if (plotEl.scrollHeight > plotEl.clientHeight + 1) {
          showMoreButton.removeClass("obs-plugin-modal-detail-show-more-hidden");
        }
      });
    }
    function rederDetailSection(type2, value) {
      const detailElement = modalContainer.createEl("div", { cls: "obs-plugin-modal-detail-detail-container" });
      detailElement.createEl("p", {
        text: `${type2}:`,
        cls: "obs-plugin-modal-detail-label"
      });
      detailElement.createEl("p", {
        text: value,
        cls: "obs-plugin-modal-detail-detail-value"
      });
    }
    modalContainer.createEl("hr");
    if (this.movie.genre) {
      rederDetailSection("Genre", this.movie.genre);
    }
    if (this.movie.actors) {
      rederDetailSection("Actors", this.movie.actors);
    }
    modalContainer.createEl("hr");
    const ratingWrapper = modalContainer.createDiv({ cls: "obs-plugin-modal-detail-rating-wrapper" });
    const ratingContainer = ratingWrapper.createDiv({
      cls: "obs-plugin-modal-detail-rating-container"
    });
    ratingContainer.createEl("div", { text: "Rating", cls: "obs-plugin-modal-detail-rating-label" });
    createStarRating(ratingContainer, this.movie.starRating, false, (rating) => {
      this.onRate(rating);
    });
    if (this.movie.ratings) {
      const externalRatingsContainer = ratingWrapper.createDiv({ cls: "obs-plugin-modal-detail-rating-container" });
      externalRatingsContainer.createEl("div", {
        text: "External rating",
        cls: "obs-plugin-modal-detail-rating-label"
      });
      renderExternalRatingBar(externalRatingsContainer, this.movie.ratings);
      modalContainer.createEl("p", {
        text: "The external rating is an average based on votes from Internet Movie Database, Rotten Tomatoes and Metacritic",
        cls: "obs-plugin-modal-detail-rating-disclaimer"
      });
    }
    const actions = modalContainer.createDiv({ cls: "obs-plugin-modal-detail-actions" });
    const toggleWatchedLabel = this.movie.watched ? "Mark as to watch" : "Mark as watched";
    const toggleWatchedButton = actions.createEl("button", { text: toggleWatchedLabel });
    const removeButton = actions.createEl("button", { text: "Remove", cls: "obs-plugin-danger" });
    toggleWatchedButton.addEventListener("click", () => {
      this.onToggleWatched();
      this.close();
    });
    removeButton.addEventListener("click", () => {
      this.onRemove();
      this.close();
    });
  }
};

// src/ui/JsonFileSuggestModal.ts
var import_obsidian3 = require("obsidian");
var JsonFileSuggestModal = class extends import_obsidian3.SuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
    this.jsonFiles = this.app.vault.getFiles().filter((f) => f.extension === "json");
    this.setPlaceholder("Select a JSON file from your vault...");
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    return this.jsonFiles.filter(
      (file) => file.path.toLowerCase().includes(lowerQuery)
    );
  }
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.path });
  }
  onChooseSuggestion(file, evt) {
    this.onSelect(file);
  }
};

// src/services/libraryStorage.ts
var DEFAULT_NAME = `${JSON_NAME}.json`;
function getDefaultPath(folder) {
  const folderPath = folder != null ? folder : FOLDER;
  return `${folderPath}/${DEFAULT_NAME}`;
}
function getFolder(folder) {
  return folder != null ? folder : FOLDER;
}
function createEmptyMovie() {
  return {
    id: crypto.randomUUID(),
    imdbId: "",
    title: "",
    year: "",
    rated: "",
    released: "",
    runtime: "",
    genre: "",
    director: "",
    writer: "",
    actors: "",
    plot: "",
    language: "",
    country: "",
    awards: "",
    poster: "",
    posterLocal: "",
    ratings: [],
    metascore: "",
    imdbRating: "",
    imdbVotes: "",
    type: "",
    dvd: "",
    boxOffice: "",
    production: "",
    website: "",
    totalSeasons: "",
    tomatoURL: "",
    tomatoMeter: "",
    tomatoImage: "",
    tomatoRating: "",
    tomatoReviews: "",
    tomatoFresh: "",
    tomatoRotten: "",
    tomatoConsensus: "",
    tomatoUserMeter: "",
    tomatoUserRating: "",
    tomatoUserReviews: "",
    starRating: 0,
    watched: false,
    notes: ""
  };
}
function createDefaultData() {
  const now = new Date().toISOString();
  return {
    schemaVersion: 1,
    createdAt: now,
    updatedAt: now,
    libraryName: "CineVault",
    owner: "",
    source: "CineVault",
    movies: []
  };
}
function normalizeData(data) {
  return {
    ...data,
    movies: data.movies.map((movie) => ({
      ...createEmptyMovie(),
      ...movie,
      year: movie.year ? String(movie.year) : "",
      starRating: typeof movie.starRating === "number" ? movie.starRating : 0
    }))
  };
}
async function ensureFolder(app, folder) {
  const folderPath = getFolder(folder);
  if (!app.vault.getAbstractFileByPath(folderPath)) {
    await app.vault.createFolder(folderPath);
  }
}
async function createJsonFile(app, folder) {
  const folderPath = getFolder(folder);
  await ensureFolder(app, folder);
  const existing = app.vault.getAbstractFileByPath(getDefaultPath(folder));
  const filename = existing ? `boxoffice-${Date.now()}.json` : DEFAULT_NAME;
  const path = `${folderPath}/${filename}`;
  return app.vault.create(path, JSON.stringify(createDefaultData(), null, 2));
}
async function loadLocalFile(app, file) {
  const raw = await app.vault.read(file);
  const parsed = JSON.parse(raw);
  if (!parsed || !Array.isArray(parsed.movies)) {
    throw new Error("Formato JSON non valido");
  }
  return normalizeData(parsed);
}
async function saveLocalData(app, file, data) {
  await app.vault.modify(file, JSON.stringify(data, null, 2));
}

// src/services/omdbService.ts
var import_obsidian4 = require("obsidian");
async function searchOmdb(query, apiKey, type, year) {
  if (!apiKey) {
    return [];
  }
  try {
    let url = `https://www.omdbapi.com/?apikey=${apiKey}&s=${encodeURIComponent(query)}`;
    if (type) {
      url += `&type=${encodeURIComponent(type)}`;
    }
    if (year) {
      url += `&y=${encodeURIComponent(year)}`;
    }
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data == null ? void 0 : data.Search) {
      return data.Search.map((item) => ({
        imdbId: item.imdbID,
        title: item.Title,
        year: item.Year,
        type: item.Type,
        poster: item.Poster && item.Poster !== "N/A" ? item.Poster : "",
        plot: ""
      }));
    }
    return [];
  } catch (error) {
    console.error("Error searching OMDb:", error);
    return [];
  }
}
async function getOmdbDetails(imdbId, apiKey, depth = 0) {
  if (depth >= 3) {
    console.error(`Failed to fetch movie details after ${depth} attempts`);
    return null;
  }
  if (!apiKey) {
    return null;
  }
  try {
    const url = `https://www.omdbapi.com/?apikey=${apiKey}&i=${imdbId}&plot=full&tomatoes=true`;
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data.Response !== "True") {
      console.error("OMDb API returned error response", data);
      return null;
    }
    return data;
  } catch (error) {
    console.error("Error fetching movie details, retrying...", error);
    return getOmdbDetails(imdbId, apiKey, depth + 1);
  }
}

// src/views/pluginView.ts
var CineVaultView = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.file = null;
    this.data = null;
    this.activeTab = "toWatch";
    this.moviesContainer = null;
    this.viewMode = "grid";
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE;
  }
  getDisplayText() {
    return "BoxOffice";
  }
  // Provide a custom icon for the view's tab
  getIcon() {
    return "clapperboard";
  }
  async onOpen() {
    var _a;
    this.viewMode = (_a = this.plugin.viewMode) != null ? _a : "grid";
    await this.initializeData();
    await this.render();
  }
  async render() {
    const container = this.containerEl.children[1];
    container.empty();
    const header = container.createDiv({ cls: "obs-plugin-header" });
    header.createEl("h1", {
      text: "BoxOffice",
      cls: "obs-plugin-title"
    });
    header.createEl("p", {
      text: "This plugin allow you to manage your favorites movie and tv library into your vault.\nSearch OMDb, rate titles, and store your collection in a json file within your vault or in a separate vault.",
      cls: "obs-plugin-header-text"
    });
    if (!this.data) {
      renderOnboarding(container, async () => {
        this.file = await createJsonFile(this.plugin.app, this.plugin.libraryFolder);
        if (this.file) {
          await this.plugin.setLocalJsonPath(this.file.path);
        }
        await this.loadFile(this.file);
        await this.render();
      }, () => {
        new JsonFileSuggestModal(this.plugin.app, async (file) => {
          await this.loadFile(file);
          await this.render();
        }).open();
      });
      return;
    }
    const searchBox = container.createDiv({ cls: "obs-plugin-search" });
    const searchInputsGroup = searchBox.createDiv({ cls: "obs-plugin-search-inputs-group" });
    const searchInputContainer = searchInputsGroup.createDiv({ cls: "obs-plugin-search-input-container" });
    const searchInput = searchInputContainer.createEl("input", {
      cls: "obs-plugin-search-input",
      attr: {
        placeholder: "Search"
      }
    });
    const filterSwitch = searchInputContainer.createEl("button", {
      cls: "obs-plugin-search-clear",
      attr: {
        "aria-label": "More filter",
        title: "More filter"
      }
    });
    (0, import_obsidian5.setIcon)(filterSwitch, "sliders-horizontal");
    const moreFilterContainer = searchInputsGroup.createDiv({ cls: "obs-plugin-more-filter" });
    moreFilterContainer.style.display = "none";
    filterSwitch.addEventListener("click", () => {
      if (moreFilterContainer.style.display === "none") {
        moreFilterContainer.style.display = "flex";
      } else {
        moreFilterContainer.style.display = "none";
      }
    });
    const yearInput = moreFilterContainer.createEl("input", {
      cls: "obs-plugin-search-input",
      attr: { placeholder: "Year" }
    });
    const typeSelect = moreFilterContainer.createEl("select", { cls: "obs-plugin-search-select" });
    typeSelect.createEl("option", {
      text: "All",
      attr: {
        value: "",
        placeholder: "Type"
      }
    });
    OMDB_TYPES.forEach((t) => {
      typeSelect.createEl("option", {
        text: t[0].toUpperCase() + t.slice(1),
        attr: { value: t }
      });
    });
    let resultsList = null;
    const content = container.createDiv({ cls: "obs-plugin-content" });
    this.moviesContainer = content;
    this.renderMovies(content);
    let searchTimeout = null;
    const runSearch = async () => {
      const query = searchInput.value.trim();
      if (!query)
        return;
      const type = typeSelect.value || void 0;
      const year = yearInput.value.trim() || void 0;
      const results = await searchOmdb(query, this.plugin.omdbApiKey, type, year);
      if (!results || results.length === 0) {
        if (!resultsList)
          resultsList = searchBox.createDiv({ cls: "obs-plugin-search-results" });
        resultsList.empty();
        resultsList.createEl("div", { text: "No results found.", cls: "obs-plugin-search-empty" });
        return;
      }
      if (!resultsList)
        resultsList = searchBox.createDiv({ cls: "obs-plugin-search-results" });
      await this.renderSearchResults(resultsList, results);
    };
    searchInput.addEventListener("input", () => {
      if (!searchInput.value.trim()) {
        if (resultsList) {
          resultsList.empty();
          resultsList.remove();
          resultsList = null;
        }
        if (searchTimeout) {
          window.clearTimeout(searchTimeout);
          searchTimeout = null;
        }
        return;
      }
      if (searchTimeout)
        window.clearTimeout(searchTimeout);
      searchTimeout = window.setTimeout(runSearch, 350);
    });
    yearInput.addEventListener("input", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
    typeSelect.addEventListener("change", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
  }
  renderMovies(container) {
    container.empty();
    if (!this.data) {
      container.createEl("p", { text: "No library loaded." });
      return;
    }
    const watched = this.data.movies.filter((movie) => movie.watched);
    const toWatch = this.data.movies.filter((movie) => !movie.watched);
    const tabsContainer = container.createDiv({ cls: "obs-plugin-tabs-container" });
    const tabHeader = tabsContainer.createDiv({ cls: "obs-plugin-tab-header" });
    const tabButtons = tabHeader.createDiv({ cls: "obs-plugin-tab-buttons" });
    const viewToggle = tabHeader.createDiv({ cls: "obs-plugin-view-toggle" });
    const toWatchButton = tabButtons.createEl("button", {
      cls: "obs-plugin-tab-button",
      text: `To Watch (${toWatch.length})`
    });
    const watchedButton = tabButtons.createEl("button", {
      cls: "obs-plugin-tab-button",
      text: `Watched (${watched.length})`
    });
    const gridButton = viewToggle.createEl("button", {
      cls: "obs-plugin-view-button",
      attr: { "aria-label": "Grid view", title: "Grid view" }
    });
    const listButton = viewToggle.createEl("button", {
      cls: "obs-plugin-view-button",
      attr: { "aria-label": "List view", title: "List view" }
    });
    (0, import_obsidian5.setIcon)(gridButton, "layout-grid");
    (0, import_obsidian5.setIcon)(listButton, "list");
    if (this.activeTab === "toWatch") {
      toWatchButton.classList.add("obs-plugin-tab-button-active");
    } else {
      watchedButton.classList.add("obs-plugin-tab-button-active");
    }
    if (this.viewMode === "grid") {
      gridButton.classList.add("obs-plugin-view-button-active");
    } else {
      listButton.classList.add("obs-plugin-view-button-active");
    }
    const tabContent = tabsContainer.createDiv({ cls: "obs-plugin-tab-content" });
    const activeMovies = this.activeTab === "toWatch" ? toWatch : watched;
    const activeTitle = this.activeTab === "toWatch" ? "To Watch" : "Watched";
    this.renderMovieSection(tabContent, activeTitle, activeMovies);
    toWatchButton.addEventListener("click", () => {
      if (this.activeTab === "toWatch")
        return;
      this.activeTab = "toWatch";
      this.renderMovies(container);
    });
    watchedButton.addEventListener("click", () => {
      if (this.activeTab === "watched")
        return;
      this.activeTab = "watched";
      this.renderMovies(container);
    });
    gridButton.addEventListener("click", async () => {
      if (this.viewMode === "grid")
        return;
      this.viewMode = "grid";
      await this.plugin.setViewMode("grid");
      this.renderMovies(container);
    });
    listButton.addEventListener("click", async () => {
      if (this.viewMode === "list")
        return;
      this.viewMode = "list";
      await this.plugin.setViewMode("list");
      this.renderMovies(container);
    });
  }
  renderMovieSection(container, title, movies) {
    const section = container.createDiv({ cls: "obs-plugin-section" });
    if (movies.length === 0) {
      section.createEl("p", { text: "No movies in this list." });
      return;
    }
    const list = section.createDiv({
      cls: this.viewMode === "grid" ? "obs-plugin-movie-grid" : "obs-plugin-movie-list"
    });
    if (this.viewMode === "grid") {
      this.renderMovieGrid(list, movies);
    } else {
      this.renderMovieList(list, movies);
    }
  }
  renderMovieGrid(container, movies) {
    movies.forEach((movie) => {
      const card = container.createDiv({ cls: "obs-plugin-movie-card" });
      card.createEl("img", { cls: "obs-plugin-movie-poster" }).setAttribute("src", movie.poster);
      card.createEl("div", { text: movie.title, cls: "obs-plugin-movie-title" });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year)
        detailsParts.push(year);
      if (type)
        detailsParts.push(type);
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        card.createEl("div", { text: detailsText, cls: "obs-plugin-movie-year" });
      }
      if (movie.watched) {
        createStarRating(card, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(card, movie.ratings);
        }
      }
      card.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  renderMovieList(container, movies) {
    movies.forEach((movie) => {
      const row = container.createDiv({
        cls: "obs-plugin-movie-row"
      });
      const poster = row.createEl("img", {
        cls: "obs-plugin-movie-thumbnail"
      });
      poster.setAttribute("src", movie.poster || "");
      const info = row.createDiv({
        cls: "obs-plugin-movie-info"
      });
      info.createEl("div", {
        text: movie.title,
        cls: "obs-plugin-movie-title"
      });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year) {
        detailsParts.push(year);
      }
      ;
      if (type) {
        detailsParts.push(type);
      }
      ;
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        info.createEl("div", {
          text: detailsText,
          cls: "obs-plugin-movie-year"
        });
      }
      if (movie.watched) {
        createStarRating(info, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(info, movie.ratings);
        }
      }
      row.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  openMovieDetails(movie) {
    new CineVaultMovieDetailModal(this.plugin.app, movie, async (rating) => {
      if (!this.data)
        return;
      movie.starRating = rating;
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      this.data.movies = this.data.movies.filter((item) => item.id !== movie.id);
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      movie.watched = !movie.watched;
      await this.saveData();
      this.refreshMovies();
    }).open();
  }
  refreshMovies() {
    if (!this.moviesContainer)
      return;
    this.renderMovies(this.moviesContainer);
  }
  getJsonFiles() {
    return this.plugin.app.vault.getFiles().filter((file) => file.extension === "json");
  }
  async initializeData() {
    const localPath = this.plugin.localJsonPath;
    if (localPath) {
      const localFile = this.plugin.app.vault.getAbstractFileByPath(localPath);
      if (localFile instanceof import_obsidian5.TFile) {
        await this.loadFile(localFile);
        return;
      }
    }
    this.file = null;
    this.data = null;
  }
  async loadFile(file) {
    try {
      const parsed = await loadLocalFile(this.plugin.app, file);
      this.file = file;
      this.data = parsed;
      await this.plugin.setLocalJsonPath(file.path);
    } catch (error) {
      this.data = null;
      this.file = null;
      new import_obsidian5.Notice("Unable to read the JSON file.");
    }
  }
  async saveData() {
    if (!this.data)
      return;
    this.data.updatedAt = new Date().toISOString();
    if (this.file) {
      await saveLocalData(this.plugin.app, this.file, this.data);
    }
  }
  async renderSearchResults(container, results) {
    container.empty();
    results.forEach((result) => {
      const item = container.createDiv({ cls: "obs-plugin-search-item" });
      if (result.poster) {
        item.createEl("img", { cls: "obs-plugin-search-poster" }).setAttribute("src", result.poster);
      }
      const info = item.createDiv({ cls: "obs-plugin-search-info" });
      info.createEl("div", { text: result.title, cls: "obs-plugin-search-title" });
      info.createEl("div", { text: result.year, cls: "obs-plugin-search-year" });
      item.addEventListener("click", () => {
        new CineVaultMovieActionModal(this.plugin.app, result, async (watched) => {
          if (!this.data)
            return;
          const existing = this.data.movies.find((movie) => movie.imdbId === result.imdbId);
          if (existing) {
            existing.watched = watched;
          } else {
            new import_obsidian5.Notice(`Loading details for ${result.title}...`);
            const details = await getOmdbDetails(result.imdbId, this.plugin.omdbApiKey);
            if (!details) {
              new import_obsidian5.Notice("Unable to load movie details.");
              return;
            }
            const newMovie = createEmptyMovie();
            newMovie.imdbId = details.imdbID || result.imdbId;
            newMovie.title = details.Title || result.title;
            newMovie.year = details.Year || result.year;
            newMovie.rated = details.Rated || "";
            newMovie.released = details.Released || "";
            newMovie.runtime = details.Runtime || "";
            newMovie.genre = details.Genre || "";
            newMovie.director = details.Director || "";
            newMovie.writer = details.Writer || "";
            newMovie.actors = details.Actors || "";
            newMovie.plot = details.Plot || result.plot;
            newMovie.language = details.Language || "";
            newMovie.country = details.Country || "";
            newMovie.awards = details.Awards || "";
            newMovie.poster = details.Poster && details.Poster !== "N/A" ? details.Poster : result.poster;
            newMovie.posterLocal = "";
            newMovie.ratings = details.Ratings || [];
            newMovie.metascore = details.Metascore || "";
            newMovie.imdbRating = details.imdbRating || "";
            newMovie.imdbVotes = details.imdbVotes || "";
            newMovie.type = details.Type || result.type;
            newMovie.dvd = details.DVD || "";
            newMovie.boxOffice = details.BoxOffice || "";
            newMovie.production = details.Production || "";
            newMovie.website = details.Website || "";
            newMovie.totalSeasons = details.totalSeasons || "";
            newMovie.watched = watched;
            this.data.movies.push(newMovie);
          }
          await this.saveData();
          this.render();
        }).open();
      });
    });
  }
};

// src/settings/settingsTab.ts
var import_obsidian6 = require("obsidian");
var CineVaultSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian6.Setting(containerEl).setName("Configuration").setHeading();
    new import_obsidian6.Setting(containerEl).setName("OMDb API key").setDesc("Enter your OMDb API key. You can get one for free at omdbapi.com").addText((text) => text.setPlaceholder("Enter your API key").setValue(this.plugin.omdbApiKey).onChange(async (value) => {
      await this.plugin.setOmdbApiKey(value);
    }));
    new import_obsidian6.Setting(containerEl).setName("Library folder").setDesc("The folder where the plugin will store library files").addText((text) => text.setPlaceholder("Folder name").setValue(this.plugin.libraryFolder).onChange(async (value) => {
      const folder = value.trim() || "BoxOffice";
      await this.plugin.setLibraryFolder(folder);
    }));
    new import_obsidian6.Setting(containerEl).setName("Linked local library").setDesc(
      this.plugin.localJsonPath ? `Local file: ${this.plugin.localJsonPath}` : "No local library linked"
    ).addDropdown((drop) => {
      var _a;
      const files = this.app.vault.getFiles().filter((f) => f.extension === "json");
      const options = { "": "-- None --" };
      files.forEach((f) => options[f.path] = f.path);
      drop.addOptions(options).setValue((_a = this.plugin.localJsonPath) != null ? _a : "").onChange(async (value) => {
        const path = value || null;
        await this.plugin.setLocalJsonPath(path);
        await this.refreshOpenViews();
        this.display();
      });
    }).addButton((button) => button.setButtonText("Unlink local").setDisabled(!this.plugin.localJsonPath).onClick(async () => {
      await this.plugin.setLocalJsonPath(null);
      await this.refreshOpenViews();
      this.display();
    }));
    new import_obsidian6.Setting(containerEl).setName("Create new library").setDesc("Create a new empty local library from scratch. This will unlink any external library.").addButton((button) => button.setButtonText("Create library").onClick(async () => {
      await this.createNewLibrary();
    }));
    new import_obsidian6.Setting(containerEl).setName("Export library").setDesc("Save a copy of your library JSON to a file.").addButton((button) => button.setButtonText("Export JSON").onClick(async () => {
      await this.exportLibraryJson();
    }));
    new import_obsidian6.Setting(containerEl).setName("Bugfix").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Report issues").setDesc("If you encounter any issues with the plugin, please report them. Your feedback is invaluable for improving BoxOffice!").addButton((button) => button.setButtonText("GitHub").onClick(() => {
      window.open("https://github.com/vscaperrotta/obsidian-cinevault/issues", "_blank");
    }));
    new import_obsidian6.Setting(containerEl).setName("Support").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Donate").setDesc(
      "If you like this plugin, consider donating to support continued development."
    ).addButton((bt) => {
      bt.buttonEl.outerHTML = "<a href='https://ko-fi.com/T6T01TX807' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi6.png?v=6' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a>";
    });
  }
  async exportLibraryJson() {
    try {
      const content = await this.getLibraryJsonContent();
      if (!content) {
        new import_obsidian6.Notice("No library file found to export.");
        return;
      }
      const timestamp = new Date().toISOString().replace(/[:.]/g, "-").slice(0, 19);
      const exportPath = `boxoffice-export-${timestamp}.json`;
      let finalPath = exportPath;
      let counter = 1;
      while (this.app.vault.getAbstractFileByPath(finalPath)) {
        finalPath = `boxoffice-export-${timestamp}-${counter}.json`;
        counter++;
      }
      await this.app.vault.create(finalPath, content);
      new import_obsidian6.Notice(`Library exported to ${finalPath}`);
    } catch (error) {
      console.error("[BoxOffice] Export library error", error);
      new import_obsidian6.Notice("Unable to export the library.");
    }
  }
  async createNewLibrary() {
    const confirmed = window.confirm(
      "Create a new empty BoxOffice library? This will unlink any external library and reset your local library data."
    );
    if (!confirmed)
      return;
    try {
      const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
      let createdFile;
      if (defaultFile instanceof import_obsidian6.TFile) {
        await saveLocalData(this.app, defaultFile, createDefaultData());
        createdFile = defaultFile;
      } else {
        createdFile = await createJsonFile(this.app, this.plugin.libraryFolder);
      }
      if (createdFile) {
        await this.plugin.setLocalJsonPath(createdFile.path);
      }
      await this.refreshOpenViews();
      this.display();
      new import_obsidian6.Notice("New library created.");
    } catch (error) {
      console.error("[BoxOffice] Create new library error", error);
      new import_obsidian6.Notice("Unable to create a new library.");
    }
  }
  async getLibraryJsonContent() {
    if (this.plugin.localJsonPath) {
      const localPath = this.plugin.localJsonPath;
      const file = this.app.vault.getAbstractFileByPath(localPath);
      if (file instanceof import_obsidian6.TFile) {
        return this.app.vault.read(file);
      }
    }
    const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
    if (defaultFile instanceof import_obsidian6.TFile) {
      return this.app.vault.read(defaultFile);
    }
    const folder = getFolder(this.plugin.libraryFolder);
    const fallback = this.app.vault.getFiles().find((file) => file.extension === "json" && file.path.startsWith(`${folder}/`));
    if (fallback) {
      return this.app.vault.read(fallback);
    }
    return null;
  }
  async refreshOpenViews() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    for (const leaf of leaves) {
      if (leaf.view instanceof CineVaultView) {
        await leaf.view.onOpen();
      }
    }
  }
};

// src/main.ts
var CineVaultPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.localJsonPath = null;
    this.omdbApiKey = "";
    this.viewMode = "grid";
    this.libraryFolder = FOLDER;
  }
  // Load plugin data and register views/settings when the plugin is loaded
  async onload() {
    await this.loadPluginData();
    this.addSettingTab(new CineVaultSettingTab(this.app, this));
    this.registerView(
      VIEW_TYPE,
      (leaf) => new CineVaultView(leaf, this)
    );
    this.addRibbonIcon("clapperboard", "BoxOffice", async () => {
      await this.openNewTab();
    });
  }
  // Unmount the status bar element when the plugin is disabled
  onunload() {
  }
  async loadPluginData() {
    var _a, _b, _c, _d;
    const data = await this.loadData();
    this.localJsonPath = (_a = data == null ? void 0 : data.localJsonPath) != null ? _a : null;
    this.omdbApiKey = (_b = data == null ? void 0 : data.omdbApiKey) != null ? _b : "";
    this.viewMode = (_c = data == null ? void 0 : data.viewMode) != null ? _c : "grid";
    this.libraryFolder = (_d = data == null ? void 0 : data.libraryFolder) != null ? _d : FOLDER;
  }
  async setOmdbApiKey(apiKey) {
    this.omdbApiKey = apiKey;
    await this.savePluginData();
  }
  async setViewMode(viewMode) {
    this.viewMode = viewMode;
    await this.savePluginData();
  }
  async savePluginData() {
    const data = {
      omdbApiKey: this.omdbApiKey,
      viewMode: this.viewMode,
      libraryFolder: this.libraryFolder
    };
    if (this.localJsonPath) {
      data.localJsonPath = this.localJsonPath;
    }
    await this.saveData(data);
  }
  async setLocalJsonPath(path) {
    this.localJsonPath = path;
    await this.savePluginData();
  }
  async setLibraryFolder(folder) {
    this.libraryFolder = folder;
    await this.savePluginData();
  }
  // Open a new tab with the "BoxOffice" view type
  async openNewTab() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: VIEW_TYPE,
      active: true
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbnN0YW50cy50cyIsICJzcmMvdmlld3MvcGx1Z2luVmlldy50cyIsICJzcmMvdWkvb25ib2FyZGluZy50cyIsICJzcmMvdWkvbW9kYWxzL2FjdGlvbk1vZGFsLnRzIiwgInNyYy91aS9tb2RhbHMvZGV0YWlsTW9kYWwudHMiLCAic3JjL3VpL3N0YXJSYXRpbmcudHMiLCAic3JjL3V0aWxzL2dsb2JhbE1ldGhvZHMudHMiLCAic3JjL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9zZXJ2aWNlcy9saWJyYXJ5U3RvcmFnZS50cyIsICJzcmMvc2VydmljZXMvb21kYlNlcnZpY2UudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZJRVdfVFlQRSwgRk9MREVSIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgcGx1Z2luVmlldyBmcm9tIFwiLi92aWV3cy9wbHVnaW5WaWV3XCI7XG5pbXBvcnQgQ2luZVZhdWx0U2V0dGluZ1RhYiBmcm9tIFwiLi9zZXR0aW5ncy9zZXR0aW5nc1RhYlwiO1xuXG50eXBlIENpbmVWYXVsdFBsdWdpbkRhdGEgPSB7XG5cdGxvY2FsSnNvblBhdGg/OiBzdHJpbmc7XG5cdG9tZGJBcGlLZXk/OiBzdHJpbmc7XG5cdHZpZXdNb2RlPzogXCJncmlkXCIgfCBcImxpc3RcIjtcblx0bGlicmFyeUZvbGRlcj86IHN0cmluZztcblx0b3Blbj86IGJvb2xlYW47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRsb2NhbEpzb25QYXRoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0b21kYkFwaUtleTogc3RyaW5nID0gXCJcIjtcblx0dmlld01vZGU6IFwiZ3JpZFwiIHwgXCJsaXN0XCIgPSBcImdyaWRcIjtcblx0bGlicmFyeUZvbGRlcjogc3RyaW5nID0gRk9MREVSO1xuXG5cdC8vIExvYWQgcGx1Z2luIGRhdGEgYW5kIHJlZ2lzdGVyIHZpZXdzL3NldHRpbmdzIHdoZW4gdGhlIHBsdWdpbiBpcyBsb2FkZWRcblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFBsdWdpbkRhdGEoKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQ2luZVZhdWx0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRWSUVXX1RZUEUsXG5cdFx0XHQobGVhZikgPT4gbmV3IHBsdWdpblZpZXcobGVhZiwgdGhpcylcblx0XHQpO1xuXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKFwiY2xhcHBlcmJvYXJkXCIsIFwiQm94T2ZmaWNlXCIsIGFzeW5jICgpID0+IHtcblx0XHRcdGF3YWl0IHRoaXMub3Blbk5ld1RhYigpO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gVW5tb3VudCB0aGUgc3RhdHVzIGJhciBlbGVtZW50IHdoZW4gdGhlIHBsdWdpbiBpcyBkaXNhYmxlZFxuXHRvbnVubG9hZCgpIHtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZFBsdWdpbkRhdGEoKSB7XG5cdFx0Y29uc3QgZGF0YSA9IChhd2FpdCB0aGlzLmxvYWREYXRhKCkpIGFzIENpbmVWYXVsdFBsdWdpbkRhdGEgfCBudWxsO1xuXHRcdHRoaXMubG9jYWxKc29uUGF0aCA9IGRhdGE/LmxvY2FsSnNvblBhdGggPz8gbnVsbDtcblx0XHR0aGlzLm9tZGJBcGlLZXkgPSBkYXRhPy5vbWRiQXBpS2V5ID8/IFwiXCI7XG5cdFx0dGhpcy52aWV3TW9kZSA9IGRhdGE/LnZpZXdNb2RlID8/IFwiZ3JpZFwiO1xuXHRcdHRoaXMubGlicmFyeUZvbGRlciA9IGRhdGE/LmxpYnJhcnlGb2xkZXIgPz8gRk9MREVSO1xuXHR9XG5cblx0YXN5bmMgc2V0T21kYkFwaUtleShhcGlLZXk6IHN0cmluZykge1xuXHRcdHRoaXMub21kYkFwaUtleSA9IGFwaUtleTtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRhc3luYyBzZXRWaWV3TW9kZSh2aWV3TW9kZTogXCJncmlkXCIgfCBcImxpc3RcIikge1xuXHRcdHRoaXMudmlld01vZGUgPSB2aWV3TW9kZTtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHNhdmVQbHVnaW5EYXRhKCkge1xuXHRcdGNvbnN0IGRhdGE6IENpbmVWYXVsdFBsdWdpbkRhdGEgPSB7XG5cdFx0XHRvbWRiQXBpS2V5OiB0aGlzLm9tZGJBcGlLZXksXG5cdFx0XHR2aWV3TW9kZTogdGhpcy52aWV3TW9kZSxcblx0XHRcdGxpYnJhcnlGb2xkZXI6IHRoaXMubGlicmFyeUZvbGRlclxuXHRcdH07XG5cdFx0aWYgKHRoaXMubG9jYWxKc29uUGF0aCkge1xuXHRcdFx0ZGF0YS5sb2NhbEpzb25QYXRoID0gdGhpcy5sb2NhbEpzb25QYXRoO1xuXHRcdH1cblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKGRhdGEpO1xuXHR9XG5cblx0YXN5bmMgc2V0TG9jYWxKc29uUGF0aChwYXRoOiBzdHJpbmcgfCBudWxsKSB7XG5cdFx0dGhpcy5sb2NhbEpzb25QYXRoID0gcGF0aDtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRhc3luYyBzZXRMaWJyYXJ5Rm9sZGVyKGZvbGRlcjogc3RyaW5nKSB7XG5cdFx0dGhpcy5saWJyYXJ5Rm9sZGVyID0gZm9sZGVyO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdC8vIE9wZW4gYSBuZXcgdGFiIHdpdGggdGhlIFwiQm94T2ZmaWNlXCIgdmlldyB0eXBlXG5cdHByaXZhdGUgYXN5bmMgb3Blbk5ld1RhYigpIHtcblx0XHRjb25zdCBleGlzdGluZ0xlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFKTtcblx0XHRpZiAoZXhpc3RpbmdMZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYoZXhpc3RpbmdMZWF2ZXNbMF0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcblx0XHRhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XG5cdFx0XHR0eXBlOiBWSUVXX1RZUEUsXG5cdFx0XHRhY3RpdmU6IHRydWVcblx0XHR9KTtcblx0fVxufSIsICJleHBvcnQgY29uc3QgTkFNRSA9IFwiQm94T2ZmaWNlXCI7XG5leHBvcnQgY29uc3QgVklFV19UWVBFID0gXCJCb3hPZmZpY2VWaWV3XCI7XG5leHBvcnQgY29uc3QgRk9MREVSID0gXCJCb3hPZmZpY2VcIjtcbmV4cG9ydCBjb25zdCBKU09OX05BTUUgPSBcImJveG9mZmljZVwiO1xuZXhwb3J0IGNvbnN0IE9NREJfVFlQRVMgPSBbXCJtb3ZpZVwiLCBcInNlcmllc1wiLCBcImVwaXNvZGVcIl0gYXMgY29uc3Q7IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBURmlsZSwgTm90aWNlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUsIE9NREJfVFlQRVMgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdERhdGEsIENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgcmVuZGVyT25ib2FyZGluZyB9IGZyb20gXCIuLi91aS9vbmJvYXJkaW5nXCI7XG5pbXBvcnQgeyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIH0gZnJvbSBcIi4uL3VpL21vZGFscy9hY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IHsgQ2luZVZhdWx0TW92aWVEZXRhaWxNb2RhbCB9IGZyb20gXCIuLi91aS9tb2RhbHMvZGV0YWlsTW9kYWxcIjtcbmltcG9ydCB7IEpzb25GaWxlU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIi4uL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQge1xuICBjcmVhdGVFbXB0eU1vdmllLFxuICBjcmVhdGVKc29uRmlsZSxcbiAgbG9hZExvY2FsRmlsZSxcbiAgc2F2ZUxvY2FsRGF0YVxufSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcbmltcG9ydCB7IHNlYXJjaE9tZGIsIGdldE9tZGJEZXRhaWxzIH0gZnJvbSBcIi4uL3NlcnZpY2VzL29tZGJTZXJ2aWNlXCI7XG5pbXBvcnQgeyBjcmVhdGVTdGFyUmF0aW5nIH0gZnJvbSBcIi4uL3VpL3N0YXJSYXRpbmdcIjtcbmltcG9ydCB7IG51bGxTYWZlLCByZW5kZXJFeHRlcm5hbFJhdGluZ0JhciB9IGZyb20gXCJzcmMvdXRpbHMvZ2xvYmFsTWV0aG9kc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXG4gIHBsdWdpbjogQ2luZVZhdWx0UGx1Z2luO1xuICBmaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuICBkYXRhOiBDaW5lVmF1bHREYXRhIHwgbnVsbCA9IG51bGw7XG4gIGFjdGl2ZVRhYjogXCJ0b1dhdGNoXCIgfCBcIndhdGNoZWRcIiA9IFwidG9XYXRjaFwiO1xuICBtb3ZpZXNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gIHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiID0gXCJncmlkXCI7XG5cbiAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihsZWFmKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGdldFZpZXdUeXBlKCkge1xuICAgIHJldHVybiBWSUVXX1RZUEU7XG4gIH1cblxuICBnZXREaXNwbGF5VGV4dCgpIHtcbiAgICByZXR1cm4gXCJCb3hPZmZpY2VcIjtcbiAgfVxuXG4gIC8vIFByb3ZpZGUgYSBjdXN0b20gaWNvbiBmb3IgdGhlIHZpZXcncyB0YWJcbiAgZ2V0SWNvbigpOiBzdHJpbmcge1xuICAgIHJldHVybiBcImNsYXBwZXJib2FyZFwiO1xuICB9XG5cbiAgYXN5bmMgb25PcGVuKCkge1xuICAgIHRoaXMudmlld01vZGUgPSB0aGlzLnBsdWdpbi52aWV3TW9kZSA/PyBcImdyaWRcIjtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4taGVhZGVyXCIgfSk7XG4gICAgaGVhZGVyLmNyZWF0ZUVsKFwiaDFcIiwge1xuICAgICAgdGV4dDogXCJCb3hPZmZpY2VcIixcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLXRpdGxlXCJcbiAgICB9KTtcblxuICAgIGhlYWRlci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgdGV4dDogXCJUaGlzIHBsdWdpbiBhbGxvdyB5b3UgdG8gbWFuYWdlIHlvdXIgZmF2b3JpdGVzIG1vdmllIGFuZCB0diBsaWJyYXJ5IGludG8geW91ciB2YXVsdC5cXG5TZWFyY2ggT01EYiwgcmF0ZSB0aXRsZXMsIGFuZCBzdG9yZSB5b3VyIGNvbGxlY3Rpb24gaW4gYSBqc29uIGZpbGUgd2l0aGluIHlvdXIgdmF1bHQgb3IgaW4gYSBzZXBhcmF0ZSB2YXVsdC5cIixcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWhlYWRlci10ZXh0XCJcbiAgICB9KTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICByZW5kZXJPbmJvYXJkaW5nKGNvbnRhaW5lciwgYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aGlzLmZpbGUgPSBhd2FpdCBjcmVhdGVKc29uRmlsZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgICBpZiAodGhpcy5maWxlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aCh0aGlzLmZpbGUucGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkRmlsZSh0aGlzLmZpbGUpO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAvLyBPcGVuIG1vZGFsIHRvIHNlbGVjdCBKU09OIGZpbGUgZnJvbSB2YXVsdFxuICAgICAgICBuZXcgSnNvbkZpbGVTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4uYXBwLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUoZmlsZSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSkub3BlbigpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoIGFyZWFcbiAgICBjb25zdCBzZWFyY2hCb3ggPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoXCIgfSk7XG5cbiAgICBjb25zdCBzZWFyY2hJbnB1dHNHcm91cCA9IHNlYXJjaEJveC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gtaW5wdXRzLWdyb3VwXCIgfSk7XG5cbiAgICAvLyBTZWFyY2ggdGl0bGVcbiAgICBjb25zdCBzZWFyY2hJbnB1dENvbnRhaW5lciA9IHNlYXJjaElucHV0c0dyb3VwLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLXNlYXJjaC1pbnB1dC1jb250YWluZXJcIiB9KTtcbiAgICBjb25zdCBzZWFyY2hJbnB1dCA9IHNlYXJjaElucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoLWlucHV0XCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIlNlYXJjaFwiXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBmaWx0ZXJTd2l0Y2ggPSBzZWFyY2hJbnB1dENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gtY2xlYXJcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgXCJhcmlhLWxhYmVsXCI6IFwiTW9yZSBmaWx0ZXJcIixcbiAgICAgICAgdGl0bGU6IFwiTW9yZSBmaWx0ZXJcIlxuICAgICAgfVxuICAgIH0pXG5cbiAgICBzZXRJY29uKGZpbHRlclN3aXRjaCwgXCJzbGlkZXJzLWhvcml6b250YWxcIik7XG5cbiAgICBjb25zdCBtb3JlRmlsdGVyQ29udGFpbmVyID0gc2VhcmNoSW5wdXRzR3JvdXAuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tbW9yZS1maWx0ZXJcIiB9KTtcblxuICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgZmlsdGVyU3dpdGNoLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAobW9yZUZpbHRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIikge1xuICAgICAgICBtb3JlRmlsdGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gWWVhciBmaWx0ZXJcbiAgICBjb25zdCB5ZWFySW5wdXQgPSBtb3JlRmlsdGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoLWlucHV0XCIsXG4gICAgICBhdHRyOiB7IHBsYWNlaG9sZGVyOiBcIlllYXJcIiB9XG4gICAgfSk7XG5cbiAgICAvLyBUeXBlIGZpbHRlclxuICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBtb3JlRmlsdGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwic2VsZWN0XCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoLXNlbGVjdFwiIH0pO1xuICAgIHR5cGVTZWxlY3QuY3JlYXRlRWwoXCJvcHRpb25cIiwge1xuICAgICAgdGV4dDogXCJBbGxcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgdmFsdWU6IFwiXCIsXG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIlR5cGVcIlxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgT01EQl9UWVBFUy5mb3JFYWNoKCh0KSA9PiB7XG4gICAgICB0eXBlU2VsZWN0LmNyZWF0ZUVsKFwib3B0aW9uXCIsIHtcbiAgICAgICAgdGV4dDogdFswXS50b1VwcGVyQ2FzZSgpICsgdC5zbGljZSgxKSxcbiAgICAgICAgYXR0cjogeyB2YWx1ZTogdCB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIENvbnRhaW5lciBmb3Igc2VhcmNoIHJlc3VsdHMsIGNyZWF0ZWQgb24gZGVtYW5kXG4gICAgbGV0IHJlc3VsdHNMaXN0OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1jb250ZW50XCIgfSk7XG4gICAgdGhpcy5tb3ZpZXNDb250YWluZXIgPSBjb250ZW50O1xuXG4gICAgdGhpcy5yZW5kZXJNb3ZpZXMoY29udGVudCk7XG5cbiAgICBsZXQgc2VhcmNoVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgcnVuU2VhcmNoID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICBpZiAoIXF1ZXJ5KSByZXR1cm47XG4gICAgICBjb25zdCB0eXBlID0gdHlwZVNlbGVjdC52YWx1ZSB8fCB1bmRlZmluZWQ7XG4gICAgICBjb25zdCB5ZWFyID0geWVhcklucHV0LnZhbHVlLnRyaW0oKSB8fCB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBzZWFyY2hPbWRiKHF1ZXJ5LCB0aGlzLnBsdWdpbi5vbWRiQXBpS2V5LCB0eXBlLCB5ZWFyKTtcblxuICAgICAgaWYgKCFyZXN1bHRzIHx8IHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmICghcmVzdWx0c0xpc3QpIHJlc3VsdHNMaXN0ID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLXNlYXJjaC1yZXN1bHRzXCIgfSk7XG4gICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG4gICAgICAgIHJlc3VsdHNMaXN0LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJObyByZXN1bHRzIGZvdW5kLlwiLCBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gtZW1wdHlcIiB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXJlc3VsdHNMaXN0KSByZXN1bHRzTGlzdCA9IHNlYXJjaEJveC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gtcmVzdWx0c1wiIH0pO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTZWFyY2hSZXN1bHRzKHJlc3VsdHNMaXN0LCByZXN1bHRzKTtcbiAgICB9O1xuXG4gICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSB7XG4gICAgICAgIGlmIChyZXN1bHRzTGlzdCkge1xuICAgICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QucmVtb3ZlKCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB7XG4gICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTtcbiAgICAgICAgICBzZWFyY2hUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB3aW5kb3cuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpO1xuICAgICAgc2VhcmNoVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHJ1blNlYXJjaCwgMzUwKTtcbiAgICB9KTtcblxuICAgIHllYXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkpIHJldHVybjtcbiAgICAgIGF3YWl0IHJ1blNlYXJjaCgpO1xuICAgIH0pO1xuXG4gICAgdHlwZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSByZXR1cm47XG4gICAgICBhd2FpdCBydW5TZWFyY2goKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyTW92aWVzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICBjb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBsaWJyYXJ5IGxvYWRlZC5cIiB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB3YXRjaGVkID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiBtb3ZpZS53YXRjaGVkKTtcbiAgICBjb25zdCB0b1dhdGNoID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiAhbW92aWUud2F0Y2hlZCk7XG5cbiAgICBjb25zdCB0YWJzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLXRhYnMtY29udGFpbmVyXCIgfSk7XG4gICAgY29uc3QgdGFiSGVhZGVyID0gdGFic0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi10YWItaGVhZGVyXCIgfSk7XG5cbiAgICBjb25zdCB0YWJCdXR0b25zID0gdGFiSGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLXRhYi1idXR0b25zXCIgfSk7XG4gICAgY29uc3Qgdmlld1RvZ2dsZSA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi12aWV3LXRvZ2dsZVwiIH0pO1xuXG4gICAgY29uc3QgdG9XYXRjaEJ1dHRvbiA9IHRhYkJ1dHRvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tdGFiLWJ1dHRvblwiLFxuICAgICAgdGV4dDogYFRvIFdhdGNoICgke3RvV2F0Y2gubGVuZ3RofSlgXG4gICAgfSk7XG5cbiAgICBjb25zdCB3YXRjaGVkQnV0dG9uID0gdGFiQnV0dG9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi10YWItYnV0dG9uXCIsXG4gICAgICB0ZXh0OiBgV2F0Y2hlZCAoJHt3YXRjaGVkLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3QgZ3JpZEJ1dHRvbiA9IHZpZXdUb2dnbGUuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tdmlldy1idXR0b25cIixcbiAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiR3JpZCB2aWV3XCIsIHRpdGxlOiBcIkdyaWQgdmlld1wiIH1cbiAgICB9KTtcbiAgICBjb25zdCBsaXN0QnV0dG9uID0gdmlld1RvZ2dsZS5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi12aWV3LWJ1dHRvblwiLFxuICAgICAgYXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJMaXN0IHZpZXdcIiwgdGl0bGU6IFwiTGlzdCB2aWV3XCIgfVxuICAgIH0pO1xuXG4gICAgc2V0SWNvbihncmlkQnV0dG9uLCBcImxheW91dC1ncmlkXCIpO1xuICAgIHNldEljb24obGlzdEJ1dHRvbiwgXCJsaXN0XCIpO1xuXG4gICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcInRvV2F0Y2hcIikge1xuICAgICAgdG9XYXRjaEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwib2JzLXBsdWdpbi10YWItYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2F0Y2hlZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwib2JzLXBsdWdpbi10YWItYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHtcbiAgICAgIGdyaWRCdXR0b24uY2xhc3NMaXN0LmFkZChcIm9icy1wbHVnaW4tdmlldy1idXR0b24tYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaXN0QnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJvYnMtcGx1Z2luLXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YWJDb250ZW50ID0gdGFic0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi10YWItY29udGVudFwiIH0pO1xuICAgIGNvbnN0IGFjdGl2ZU1vdmllcyA9IHRoaXMuYWN0aXZlVGFiID09PSBcInRvV2F0Y2hcIiA/IHRvV2F0Y2ggOiB3YXRjaGVkO1xuICAgIGNvbnN0IGFjdGl2ZVRpdGxlID0gdGhpcy5hY3RpdmVUYWIgPT09IFwidG9XYXRjaFwiID8gXCJUbyBXYXRjaFwiIDogXCJXYXRjaGVkXCI7XG4gICAgdGhpcy5yZW5kZXJNb3ZpZVNlY3Rpb24odGFiQ29udGVudCwgYWN0aXZlVGl0bGUsIGFjdGl2ZU1vdmllcyk7XG5cbiAgICB0b1dhdGNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5hY3RpdmVUYWIgPT09IFwidG9XYXRjaFwiKSByZXR1cm47XG4gICAgICB0aGlzLmFjdGl2ZVRhYiA9IFwidG9XYXRjaFwiO1xuICAgICAgdGhpcy5yZW5kZXJNb3ZpZXMoY29udGFpbmVyKTtcbiAgICB9KTtcblxuICAgIHdhdGNoZWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ3YXRjaGVkXCIpIHJldHVybjtcbiAgICAgIHRoaXMuYWN0aXZlVGFiID0gXCJ3YXRjaGVkXCI7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuXG4gICAgZ3JpZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMudmlld01vZGUgPT09IFwiZ3JpZFwiKSByZXR1cm47XG4gICAgICB0aGlzLnZpZXdNb2RlID0gXCJncmlkXCI7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRWaWV3TW9kZShcImdyaWRcIik7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuXG4gICAgbGlzdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMudmlld01vZGUgPT09IFwibGlzdFwiKSByZXR1cm47XG4gICAgICB0aGlzLnZpZXdNb2RlID0gXCJsaXN0XCI7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRWaWV3TW9kZShcImxpc3RcIik7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZVNlY3Rpb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgdGl0bGU6IHN0cmluZywgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgY29uc3Qgc2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1zZWN0aW9uXCIgfSk7XG4gICAgLy8gc2VjdGlvbi5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogdGl0bGUgfSk7XG5cbiAgICBpZiAobW92aWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2VjdGlvbi5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIk5vIG1vdmllcyBpbiB0aGlzIGxpc3QuXCIgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbGlzdCA9IHNlY3Rpb24uY3JlYXRlRGl2KHtcbiAgICAgIGNsczogdGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIgPyBcIm9icy1wbHVnaW4tbW92aWUtZ3JpZFwiIDogXCJvYnMtcGx1Z2luLW1vdmllLWxpc3RcIlxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMudmlld01vZGUgPT09IFwiZ3JpZFwiKSB7XG4gICAgICB0aGlzLnJlbmRlck1vdmllR3JpZChsaXN0LCBtb3ZpZXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlck1vdmllTGlzdChsaXN0LCBtb3ZpZXMpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyTW92aWVHcmlkKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIG1vdmllczogQ2luZVZhdWx0TW92aWVbXSkge1xuICAgIG1vdmllcy5mb3JFYWNoKChtb3ZpZSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1tb3ZpZS1jYXJkXCIgfSk7XG4gICAgICBjYXJkLmNyZWF0ZUVsKFwiaW1nXCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tbW92aWUtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIG1vdmllLnBvc3Rlcik7XG4gICAgICBjYXJkLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogbW92aWUudGl0bGUsIGNsczogXCJvYnMtcGx1Z2luLW1vdmllLXRpdGxlXCIgfSk7XG5cbiAgICAgIC8vIEJ1aWxkIHRoZSBkZXRhaWxzIHN0cmluZyBjb25kaXRpb25hbGx5LCBvbmx5IGluY2x1ZGluZyBub24tbnVsbC91bmRlZmluZWQgdmFsdWVzXG4gICAgICBjb25zdCBkZXRhaWxzUGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICBjb25zdCB5ZWFyID0gbnVsbFNhZmUoKCkgPT4gbW92aWUueWVhciwgbnVsbCk7XG4gICAgICBjb25zdCB0eXBlID0gbnVsbFNhZmUoKCkgPT4gbW92aWUudHlwZVswXS50b1VwcGVyQ2FzZSgpICsgbW92aWUudHlwZS5zbGljZSgxKSwgbnVsbCk7XG5cbiAgICAgIGlmICh5ZWFyKSBkZXRhaWxzUGFydHMucHVzaCh5ZWFyKTtcbiAgICAgIGlmICh0eXBlKSBkZXRhaWxzUGFydHMucHVzaCh0eXBlKTtcblxuICAgICAgY29uc3QgZGV0YWlsc1RleHQgPSBkZXRhaWxzUGFydHMuam9pbihcIiAtIFwiKTtcbiAgICAgIGlmIChkZXRhaWxzVGV4dCkge1xuICAgICAgICBjYXJkLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZGV0YWlsc1RleHQsIGNsczogXCJvYnMtcGx1Z2luLW1vdmllLXllYXJcIiB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vdmllLndhdGNoZWQpIHtcbiAgICAgICAgY3JlYXRlU3RhclJhdGluZyhjYXJkLCBtb3ZpZS5zdGFyUmF0aW5nLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChtb3ZpZS5yYXRpbmdzICYmIG1vdmllLnJhdGluZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIoY2FyZCwgbW92aWUucmF0aW5ncyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTW92aWVEZXRhaWxzKG1vdmllKSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vdmllTGlzdChjb250YWluZXI6IEhUTUxFbGVtZW50LCBtb3ZpZXM6IENpbmVWYXVsdE1vdmllW10pIHtcbiAgICBtb3ZpZXMuZm9yRWFjaCgobW92aWUpID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb3ZpZS1yb3dcIlxuICAgICAgfSk7XG4gICAgICBjb25zdCBwb3N0ZXIgPSByb3cuY3JlYXRlRWwoXCJpbWdcIiwge1xuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb3ZpZS10aHVtYm5haWxcIlxuICAgICAgfSk7XG4gICAgICBwb3N0ZXIuc2V0QXR0cmlidXRlKFwic3JjXCIsIG1vdmllLnBvc3RlciB8fCBcIlwiKTtcblxuICAgICAgY29uc3QgaW5mbyA9IHJvdy5jcmVhdGVEaXYoe1xuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb3ZpZS1pbmZvXCJcbiAgICAgIH0pO1xuXG4gICAgICBpbmZvLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogbW92aWUudGl0bGUsXG4gICAgICAgIGNsczogXCJvYnMtcGx1Z2luLW1vdmllLXRpdGxlXCJcbiAgICAgIH0pO1xuXG4gICAgICAvLyBCdWlsZCB0aGUgZGV0YWlscyBzdHJpbmcgY29uZGl0aW9uYWxseSwgb25seSBpbmNsdWRpbmcgbm9uLW51bGwvdW5kZWZpbmVkIHZhbHVlc1xuICAgICAgY29uc3QgZGV0YWlsc1BhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgY29uc3QgeWVhciA9IG51bGxTYWZlKCgpID0+IG1vdmllLnllYXIsIG51bGwpO1xuICAgICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IG1vdmllLnR5cGVbMF0udG9VcHBlckNhc2UoKSArIG1vdmllLnR5cGUuc2xpY2UoMSksIG51bGwpO1xuXG4gICAgICBpZiAoeWVhcikge1xuICAgICAgICBkZXRhaWxzUGFydHMucHVzaCh5ZWFyKVxuICAgICAgfTtcblxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgZGV0YWlsc1BhcnRzLnB1c2godHlwZSlcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRldGFpbHNUZXh0ID0gZGV0YWlsc1BhcnRzLmpvaW4oXCIgLSBcIik7XG4gICAgICBpZiAoZGV0YWlsc1RleHQpIHtcbiAgICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgdGV4dDogZGV0YWlsc1RleHQsXG4gICAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tbW92aWUteWVhclwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAobW92aWUud2F0Y2hlZCkge1xuICAgICAgICBjcmVhdGVTdGFyUmF0aW5nKGluZm8sIG1vdmllLnN0YXJSYXRpbmcsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKG1vdmllLnJhdGluZ3MgJiYgbW92aWUucmF0aW5ncy5sZW5ndGgpIHtcbiAgICAgICAgICByZW5kZXJFeHRlcm5hbFJhdGluZ0JhcihpbmZvLCBtb3ZpZS5yYXRpbmdzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMub3Blbk1vdmllRGV0YWlscyhtb3ZpZSkpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBvcGVuTW92aWVEZXRhaWxzKG1vdmllOiBDaW5lVmF1bHRNb3ZpZSkge1xuICAgIG5ldyBDaW5lVmF1bHRNb3ZpZURldGFpbE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgbW92aWUsIGFzeW5jIChyYXRpbmcpID0+IHtcbiAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm47XG4gICAgICBtb3ZpZS5zdGFyUmF0aW5nID0gcmF0aW5nO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgdGhpcy5yZWZyZXNoTW92aWVzKCk7XG4gICAgfSwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICAgIHRoaXMuZGF0YS5tb3ZpZXMgPSB0aGlzLmRhdGEubW92aWVzLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5pZCAhPT0gbW92aWUuaWQpO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgdGhpcy5yZWZyZXNoTW92aWVzKCk7XG4gICAgfSwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICAgIG1vdmllLndhdGNoZWQgPSAhbW92aWUud2F0Y2hlZDtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEoKTtcbiAgICAgIHRoaXMucmVmcmVzaE1vdmllcygpO1xuICAgIH0pLm9wZW4oKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVmcmVzaE1vdmllcygpIHtcbiAgICBpZiAoIXRoaXMubW92aWVzQ29udGFpbmVyKSByZXR1cm47XG4gICAgdGhpcy5yZW5kZXJNb3ZpZXModGhpcy5tb3ZpZXNDb250YWluZXIpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRKc29uRmlsZXMoKTogVEZpbGVbXSB7XG4gICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZmlsZSkgPT4gZmlsZS5leHRlbnNpb24gPT09IFwianNvblwiKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZURhdGEoKSB7XG4gICAgLy8gUHJlZmVyIGEgbG9jYWxseSBsaW5rZWQgZmlsZSBpbnNpZGUgdGhlIHZhdWx0IGlmIGNvbmZpZ3VyZWRcbiAgICBjb25zdCBsb2NhbFBhdGggPSB0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoO1xuICAgIGlmIChsb2NhbFBhdGgpIHtcbiAgICAgIGNvbnN0IGxvY2FsRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobG9jYWxQYXRoKTtcbiAgICAgIGlmIChsb2NhbEZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRGaWxlKGxvY2FsRmlsZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBObyBsaW5rZWQgZmlsZXMgZm91bmQgXHUyMDE0IGRvbid0IGNyZWF0ZSBmb2xkZXJzL2ZpbGVzIGF1dG9tYXRpY2FsbHkuIFNob3cgb25ib2FyZGluZy5cbiAgICB0aGlzLmZpbGUgPSBudWxsO1xuICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRGaWxlKGZpbGU6IFRGaWxlKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IGF3YWl0IGxvYWRMb2NhbEZpbGUodGhpcy5wbHVnaW4uYXBwLCBmaWxlKTtcbiAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICB0aGlzLmRhdGEgPSBwYXJzZWQ7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKGZpbGUucGF0aCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gICAgICB0aGlzLmZpbGUgPSBudWxsO1xuICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byByZWFkIHRoZSBKU09OIGZpbGUuXCIpO1xuICAgIH1cbiAgfVxuICBwcml2YXRlIGFzeW5jIHNhdmVEYXRhKCkge1xuICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm47XG4gICAgdGhpcy5kYXRhLnVwZGF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBpZiAodGhpcy5maWxlKSB7XG4gICAgICBhd2FpdCBzYXZlTG9jYWxEYXRhKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCB0aGlzLmRhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyU2VhcmNoUmVzdWx0cyhjb250YWluZXI6IEhUTUxFbGVtZW50LCByZXN1bHRzOiBhbnlbXSkge1xuICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgcmVzdWx0cy5mb3JFYWNoKChyZXN1bHQpID0+IHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoLWl0ZW1cIiB9KTtcbiAgICAgIGlmIChyZXN1bHQucG9zdGVyKSB7XG4gICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIHJlc3VsdC5wb3N0ZXIpO1xuICAgICAgfVxuICAgICAgY29uc3QgaW5mbyA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tc2VhcmNoLWluZm9cIiB9KTtcbiAgICAgIGluZm8uY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiByZXN1bHQudGl0bGUsIGNsczogXCJvYnMtcGx1Z2luLXNlYXJjaC10aXRsZVwiIH0pO1xuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHJlc3VsdC55ZWFyLCBjbHM6IFwib2JzLXBsdWdpbi1zZWFyY2gteWVhclwiIH0pO1xuXG4gICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIG5ldyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsKHRoaXMucGx1Z2luLmFwcCwgcmVzdWx0LCBhc3luYyAod2F0Y2hlZCkgPT4ge1xuICAgICAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm47XG5cbiAgICAgICAgICBjb25zdCBleGlzdGluZyA9IHRoaXMuZGF0YS5tb3ZpZXMuZmluZCgobW92aWUpID0+IG1vdmllLmltZGJJZCA9PT0gcmVzdWx0LmltZGJJZCk7XG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICBleGlzdGluZy53YXRjaGVkID0gd2F0Y2hlZDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgTG9hZGluZyBkZXRhaWxzIGZvciAke3Jlc3VsdC50aXRsZX0uLi5gKTtcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSBhd2FpdCBnZXRPbWRiRGV0YWlscyhyZXN1bHQuaW1kYklkLCB0aGlzLnBsdWdpbi5vbWRiQXBpS2V5KTtcblxuICAgICAgICAgICAgaWYgKCFkZXRhaWxzKSB7XG4gICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJVbmFibGUgdG8gbG9hZCBtb3ZpZSBkZXRhaWxzLlwiKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBuZXdNb3ZpZSA9IGNyZWF0ZUVtcHR5TW92aWUoKTtcbiAgICAgICAgICAgIG5ld01vdmllLmltZGJJZCA9IGRldGFpbHMuaW1kYklEIHx8IHJlc3VsdC5pbWRiSWQ7XG4gICAgICAgICAgICBuZXdNb3ZpZS50aXRsZSA9IGRldGFpbHMuVGl0bGUgfHwgcmVzdWx0LnRpdGxlO1xuICAgICAgICAgICAgbmV3TW92aWUueWVhciA9IGRldGFpbHMuWWVhciB8fCByZXN1bHQueWVhcjtcbiAgICAgICAgICAgIG5ld01vdmllLnJhdGVkID0gZGV0YWlscy5SYXRlZCB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUucmVsZWFzZWQgPSBkZXRhaWxzLlJlbGVhc2VkIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5ydW50aW1lID0gZGV0YWlscy5SdW50aW1lIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5nZW5yZSA9IGRldGFpbHMuR2VucmUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmRpcmVjdG9yID0gZGV0YWlscy5EaXJlY3RvciB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUud3JpdGVyID0gZGV0YWlscy5Xcml0ZXIgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmFjdG9ycyA9IGRldGFpbHMuQWN0b3JzIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5wbG90ID0gZGV0YWlscy5QbG90IHx8IHJlc3VsdC5wbG90O1xuICAgICAgICAgICAgbmV3TW92aWUubGFuZ3VhZ2UgPSBkZXRhaWxzLkxhbmd1YWdlIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5jb3VudHJ5ID0gZGV0YWlscy5Db3VudHJ5IHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5hd2FyZHMgPSBkZXRhaWxzLkF3YXJkcyB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUucG9zdGVyID0gZGV0YWlscy5Qb3N0ZXIgJiYgZGV0YWlscy5Qb3N0ZXIgIT09IFwiTi9BXCIgPyBkZXRhaWxzLlBvc3RlciA6IHJlc3VsdC5wb3N0ZXI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5wb3N0ZXJMb2NhbCA9IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5yYXRpbmdzID0gZGV0YWlscy5SYXRpbmdzIHx8IFtdO1xuICAgICAgICAgICAgbmV3TW92aWUubWV0YXNjb3JlID0gZGV0YWlscy5NZXRhc2NvcmUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmltZGJSYXRpbmcgPSBkZXRhaWxzLmltZGJSYXRpbmcgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmltZGJWb3RlcyA9IGRldGFpbHMuaW1kYlZvdGVzIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS50eXBlID0gZGV0YWlscy5UeXBlIHx8IHJlc3VsdC50eXBlO1xuICAgICAgICAgICAgbmV3TW92aWUuZHZkID0gZGV0YWlscy5EVkQgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmJveE9mZmljZSA9IGRldGFpbHMuQm94T2ZmaWNlIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5wcm9kdWN0aW9uID0gZGV0YWlscy5Qcm9kdWN0aW9uIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS53ZWJzaXRlID0gZGV0YWlscy5XZWJzaXRlIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS50b3RhbFNlYXNvbnMgPSBkZXRhaWxzLnRvdGFsU2Vhc29ucyB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUud2F0Y2hlZCA9IHdhdGNoZWQ7XG5cbiAgICAgICAgICAgIHRoaXMuZGF0YS5tb3ZpZXMucHVzaChuZXdNb3ZpZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEoKTtcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KS5vcGVuKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufSIsICJleHBvcnQgZnVuY3Rpb24gcmVuZGVyT25ib2FyZGluZyhcbiAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgb25DcmVhdGU6ICgpID0+IHZvaWQsXG4gIG9uTGluaz86ICgpID0+IHZvaWRcbikge1xuICBjb25zdCBvbmJvYXJkaW5nID0gY29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgY2xzOiBcIm9icy1wbHVnaW4tb25ib2FyZGluZ1wiXG4gIH0pO1xuXG4gIGNvbnN0IGFjdGlvbnMgPSBvbmJvYXJkaW5nLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLW9uYm9hcmRpbmctYWN0aW9uc1wiIH0pO1xuICBjb25zdCBjcmVhdGVCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJDcmVhdGUgbmV3IGxpYnJhcnlcIiB9KTtcbiAgY3JlYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkNyZWF0ZSk7XG5cbiAgaWYgKG9uTGluaykge1xuICAgIGFjdGlvbnMuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJvclwiIH0pO1xuICAgIGNvbnN0IGxpbmtCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJMaW5rIGV4aXN0aW5nIGxpYnJhcnlcIiB9KTtcbiAgICBsaW5rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkxpbmspO1xuICB9XG59IiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdFNlYXJjaEl0ZW0gfSBmcm9tIFwiLi4vLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBjbGFzcyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBwcml2YXRlIG1vdmllOiBDaW5lVmF1bHRTZWFyY2hJdGVtO1xuICBwcml2YXRlIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBNb2RhbFtcImFwcFwiXSwgbW92aWU6IENpbmVWYXVsdFNlYXJjaEl0ZW0sIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMubW92aWUgPSBtb3ZpZTtcbiAgICB0aGlzLm9uU2F2ZSA9IG9uU2F2ZTtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogdGhpcy5tb3ZpZS50aXRsZSB9KTtcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYCR7dGhpcy5tb3ZpZS55ZWFyfSBcdTIwMjIgJHt0aGlzLm1vdmllLnR5cGV9YCB9KTtcbiAgICBpZiAodGhpcy5tb3ZpZS5wb3N0ZXIpIHtcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC1wb3N0ZXJcIiB9KS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5tb3ZpZS5wb3N0ZXIpO1xuICAgIH1cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogdGhpcy5tb3ZpZS5wbG90IH0pO1xuXG4gICAgY29uc3QgYWN0aW9ucyA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtYWN0aW9uc1wiIH0pO1xuICAgIGNvbnN0IHdhdGNoZWRCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJNYXJrIGFzIHdhdGNoZWRcIiB9KTtcbiAgICBjb25zdCB0b1dhdGNoQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiVG8gd2F0Y2hcIiB9KTtcblxuICAgIHdhdGNoZWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25TYXZlKHRydWUpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuXG4gICAgdG9XYXRjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblNhdmUoZmFsc2UpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIHsgQ2luZVZhdWx0TW92aWUgfSBmcm9tIFwiLi4vLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5pbXBvcnQgeyBjcmVhdGVTdGFyUmF0aW5nIH0gZnJvbSBcIi4uL3N0YXJSYXRpbmdcIjtcbmltcG9ydCB7IG51bGxTYWZlLCByZW5kZXJFeHRlcm5hbFJhdGluZ0JhciB9IGZyb20gXCJzcmMvdXRpbHMvZ2xvYmFsTWV0aG9kc1wiO1xuXG5leHBvcnQgY2xhc3MgQ2luZVZhdWx0TW92aWVEZXRhaWxNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcHJpdmF0ZSBtb3ZpZTogQ2luZVZhdWx0TW92aWU7XG4gIHByaXZhdGUgb25SYXRlOiAocmF0aW5nOiBudW1iZXIpID0+IHZvaWQ7XG4gIHByaXZhdGUgb25SZW1vdmU6ICgpID0+IHZvaWQ7XG4gIHByaXZhdGUgb25Ub2dnbGVXYXRjaGVkOiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGFwcDogTW9kYWxbXCJhcHBcIl0sXG4gICAgbW92aWU6IENpbmVWYXVsdE1vdmllLFxuICAgIG9uUmF0ZTogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkLFxuICAgIG9uUmVtb3ZlOiAoKSA9PiB2b2lkLFxuICAgIG9uVG9nZ2xlV2F0Y2hlZDogKCkgPT4gdm9pZFxuICApIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMubW92aWUgPSBtb3ZpZTtcbiAgICB0aGlzLm9uUmF0ZSA9IG9uUmF0ZTtcbiAgICB0aGlzLm9uUmVtb3ZlID0gb25SZW1vdmU7XG4gICAgdGhpcy5vblRvZ2dsZVdhdGNoZWQgPSBvblRvZ2dsZVdhdGNoZWQ7XG4gIH1cblxuICBvbk9wZW4oKSB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICBjb25zdCBtb2RhbENvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLWNvbnRhaW5lclwiXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2RhbEhlYWRlciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtaGVhZGVyXCJcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZGFsVGl0bGVDb250YWluZXIgPSBtb2RhbEhlYWRlci5jcmVhdGVEaXYoe1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLXRpdGxlLWNvbnRhaW5lclwiXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwiaDFcIiwge1xuICAgICAgdGV4dDogdGhpcy5tb3ZpZS50aXRsZSxcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC10aXRsZVwiXG4gICAgfSk7XG5cbiAgICAvLyBZZWFyIGFuZCBUeXBlXG4gICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IHRoaXMubW92aWUudHlwZVswXS50b1VwcGVyQ2FzZSgpICsgdGhpcy5tb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcbiAgICBjb25zdCB5ZWFyID0gbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS55ZWFyLCBudWxsKTtcblxuICAgIG1vZGFsVGl0bGVDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IGAke3llYXJ9IC0gJHt0eXBlfWAsXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkRpcmVjdGVkIGJ5IFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5kaXJlY3RvciwgXCJOL0FcIiksXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkR1cmF0aW9uIFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5ydW50aW1lLCBcIk4vQVwiKSxcbiAgICB9KTtcblxuICAgIC8vIFBvc3RlclxuICAgIGlmICh0aGlzLm1vdmllLnBvc3Rlcikge1xuICAgICAgbW9kYWxIZWFkZXIuY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMubW92aWUucG9zdGVyKTtcbiAgICB9XG5cbiAgICAvLyBQbG90XG4gICAgaWYgKHRoaXMubW92aWUucGxvdCkge1xuICAgICAgY29uc3QgcGxvdENvbnRhaW5lciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLXBsb3QtY29udGFpbmVyXCIgfSk7XG5cbiAgICAgIGNvbnN0IHBsb3RFbCA9IHBsb3RDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogdGhpcy5tb3ZpZS5wbG90LFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtcGxvdFwiXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc2hvd01vcmVCdXR0b24gPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgdGV4dDogXCJTaG93IG1vcmVcIixcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLXNob3ctbW9yZSBvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC1zaG93LW1vcmUtaGlkZGVuXCJcbiAgICAgIH0pXG5cbiAgICAgIHNob3dNb3JlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBwbG90RWwuY2xhc3NMaXN0LnRvZ2dsZShcImV4cGFuZGVkLXBsb3RcIik7XG4gICAgICAgIHNob3dNb3JlQnV0dG9uLnNldFRleHQoaXNFeHBhbmRlZCA/IFwiU2hvdyBsZXNzXCIgOiBcIlNob3cgbW9yZVwiKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBXYWl0IGZvciBsYXlvdXQgc28gd2UgY2FuIG1lYXN1cmUgb3ZlcmZsb3dcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgIC8vIElmIGNvbnRlbnQgaGVpZ2h0IGV4Y2VlZHMgY29udGFpbmVyIGhlaWdodCwgaXQncyB0cnVuY2F0ZWRcbiAgICAgICAgaWYgKHBsb3RFbC5zY3JvbGxIZWlnaHQgPiBwbG90RWwuY2xpZW50SGVpZ2h0ICsgMSkge1xuICAgICAgICAgIHNob3dNb3JlQnV0dG9uLnJlbW92ZUNsYXNzKFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgZGV0YWlscyBzZWN0aW9uIG9ubHkgaWYgYXQgbGVhc3Qgb25lIGRldGFpbCBpcyBhdmFpbGFibGVcbiAgICBmdW5jdGlvbiByZWRlckRldGFpbFNlY3Rpb24odHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICBjb25zdCBkZXRhaWxFbGVtZW50ID0gbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtZGV0YWlsLWNvbnRhaW5lclwiIH0pO1xuICAgICAgZGV0YWlsRWxlbWVudC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICB0ZXh0OiBgJHt0eXBlfTpgLFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtbGFiZWxcIlxuICAgICAgfSk7XG4gICAgICBkZXRhaWxFbGVtZW50LmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IHZhbHVlLFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtZGV0YWlsLXZhbHVlXCJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAvLyBHZW5yZVxuICAgIGlmICh0aGlzLm1vdmllLmdlbnJlKSB7XG4gICAgICByZWRlckRldGFpbFNlY3Rpb24oXCJHZW5yZVwiLCB0aGlzLm1vdmllLmdlbnJlKTtcbiAgICB9XG5cbiAgICAvLyBBY3RvcnNcbiAgICBpZiAodGhpcy5tb3ZpZS5hY3RvcnMpIHtcbiAgICAgIHJlZGVyRGV0YWlsU2VjdGlvbihcIkFjdG9yc1wiLCB0aGlzLm1vdmllLmFjdG9ycyk7XG4gICAgfVxuXG4gICAgbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgIGNvbnN0IHJhdGluZ1dyYXBwZXIgPSBtb2RhbENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtcmF0aW5nLXdyYXBwZXJcIiB9KTtcblxuICAgIC8vIFBlcnNvbmFsIFJhdGluZ1xuICAgIGNvbnN0IHJhdGluZ0NvbnRhaW5lciA9IHJhdGluZ1dyYXBwZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC1yYXRpbmctY29udGFpbmVyXCJcbiAgICB9KTtcblxuICAgIHJhdGluZ0NvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiUmF0aW5nXCIsIGNsczogXCJvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC1yYXRpbmctbGFiZWxcIiB9KTtcbiAgICBjcmVhdGVTdGFyUmF0aW5nKHJhdGluZ0NvbnRhaW5lciwgdGhpcy5tb3ZpZS5zdGFyUmF0aW5nLCBmYWxzZSwgKHJhdGluZykgPT4ge1xuICAgICAgdGhpcy5vblJhdGUocmF0aW5nKTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLm1vdmllLnJhdGluZ3MpIHtcbiAgICAgIGNvbnN0IGV4dGVybmFsUmF0aW5nc0NvbnRhaW5lciA9IHJhdGluZ1dyYXBwZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIiB9KTtcblxuICAgICAgZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogXCJFeHRlcm5hbCByYXRpbmdcIixcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tbW9kYWwtZGV0YWlsLXJhdGluZy1sYWJlbFwiXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIoZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyLCB0aGlzLm1vdmllLnJhdGluZ3MpO1xuXG4gICAgICAvLyBFeHRlcm5hbCByYXRpbmcgZGlzY2xhaW1lciBzdGF5cyBpbiB0aGUgbW9kYWxcbiAgICAgIG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IFwiVGhlIGV4dGVybmFsIHJhdGluZyBpcyBhbiBhdmVyYWdlIGJhc2VkIG9uIHZvdGVzIGZyb20gSW50ZXJuZXQgTW92aWUgRGF0YWJhc2UsIFJvdHRlbiBUb21hdG9lcyBhbmQgTWV0YWNyaXRpY1wiLFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1tb2RhbC1kZXRhaWwtcmF0aW5nLWRpc2NsYWltZXJcIlxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aW9ucyA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLW1vZGFsLWRldGFpbC1hY3Rpb25zXCIgfSk7XG4gICAgY29uc3QgdG9nZ2xlV2F0Y2hlZExhYmVsID0gdGhpcy5tb3ZpZS53YXRjaGVkID8gXCJNYXJrIGFzIHRvIHdhdGNoXCIgOiBcIk1hcmsgYXMgd2F0Y2hlZFwiO1xuICAgIGNvbnN0IHRvZ2dsZVdhdGNoZWRCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogdG9nZ2xlV2F0Y2hlZExhYmVsIH0pO1xuICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlJlbW92ZVwiLCBjbHM6IFwib2JzLXBsdWdpbi1kYW5nZXJcIiB9KTtcblxuICAgIHRvZ2dsZVdhdGNoZWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25Ub2dnbGVXYXRjaGVkKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICByZW1vdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25SZW1vdmUoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufSIsICJleHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RhclJhdGluZyhcbiAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgcmF0aW5nOiBudW1iZXIsXG4gIHJlYWRPbmx5OiBib29sZWFuLFxuICBvbkNoYW5nZT86IChyYXRpbmc6IG51bWJlcikgPT4gdm9pZFxuKSB7XG4gIGNvbnN0IHN0YXJzID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLXN0YXJzXCIgfSk7XG4gIGNvbnN0IHN0YXJFbGVtZW50czogSFRNTFNwYW5FbGVtZW50W10gPSBbXTtcbiAgbGV0IGN1cnJlbnRSYXRpbmcgPSByYXRpbmc7XG5cbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNTsgaSArPSAxKSB7XG4gICAgY29uc3Qgc3RhciA9IHN0YXJzLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiXHUyNjA1XCIsIGNsczogXCJvYnMtcGx1Z2luLXN0YXJcIiB9KTtcbiAgICBpZiAoaSA8PSByYXRpbmcpIHN0YXIuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICBzdGFyRWxlbWVudHMucHVzaChzdGFyKTtcbiAgICBpZiAoIXJlYWRPbmx5KSB7XG4gICAgICBzdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIElmIGNsaWNraW5nIHRoZSBzYW1lIHN0YXIgdGhhdCdzIGFscmVhZHkgc2VsZWN0ZWQsIHJlc2V0IHRvIDBcbiAgICAgICAgaWYgKGN1cnJlbnRSYXRpbmcgPT09IGkpIHtcbiAgICAgICAgICBjdXJyZW50UmF0aW5nID0gMDtcbiAgICAgICAgICBzdGFyRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRSYXRpbmcgPSBpO1xuICAgICAgICAgIHN0YXJFbGVtZW50cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIsIGluZGV4IDwgaSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgb25DaGFuZ2U/LihjdXJyZW50UmF0aW5nKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoXCJyZWFkb25seVwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0YXJzO1xufVxuIiwgImltcG9ydCB0eXBlIHsgTW92aWVSYXRpbmcgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbi8qKlxuICogU2FmZWx5IGV4ZWN1dGUgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyBvciByZXR1cm4gbnVsbC91bmRlZmluZWQuXG4gKiBAdGVtcGxhdGUgVFxuICogQHBhcmFtIHsoKSA9PiBUfSBmdW5jIC0gRnVuY3Rpb24gdG8gZXhlY3V0ZSBzYWZlbHkuXG4gKiBAcGFyYW0ge1QgfCBudWxsfSBbZmFsbGJhY2tWYWx1ZT1udWxsXSAtIFZhbHVlIHRvIHJldHVybiBpZiBgZnVuY2AgdGhyb3dzIG9yIHJldHVybnMgbnVsbC91bmRlZmluZWQuXG4gKiBAcmV0dXJucyB7VCB8IG51bGx9IFRoZSByZXN1bHQgb2YgYGZ1bmNgIG9yIHRoZSBwcm92aWRlZCBgZmFsbGJhY2tWYWx1ZWAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBudWxsU2FmZTxUPihmdW5jOiAoKSA9PiBULCBmYWxsYmFja1ZhbHVlOiBUIHwgbnVsbCA9IG51bGwpOiBUIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsdWUgPSBmdW5jKCk7XG4gICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyBmYWxsYmFja1ZhbHVlIDogdmFsdWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvcjogJywgZSk7XG4gICAgcmV0dXJuIGZhbGxiYWNrVmFsdWU7XG4gIH1cbn1cblxuLyoqXG4gKiBOb3JtYWxpemUgdmFyaW91cyByYXRpbmcgZm9ybWF0cyBpbnRvIGEgbnVtZXJpYyBzdHJpbmcuXG4gKiBTdXBwb3J0cyBmb3JtYXRzIGxpa2UgXCI3LzEwXCIsIFwiODUvMTAwXCIsIFwiODUlXCIsIGFuZCBkZWNpbWFscyB1c2luZyBjb21tYXMuXG4gKiAtIFwieC8xMFwiIGlzIGNvbnZlcnRlZCB0byBhIHZhbHVlIG91dCBvZiAxMDAgKG11bHRpcGxpZWQgYnkgMTApLlxuICogLSBcIngvMTAwXCIgcmV0dXJucyB0aGUgbnVtZXJpYyBwYXJ0IGJlZm9yZSB0aGUgc2xhc2guXG4gKiAtIFwieCVcIiByZW1vdmVzIHRoZSBwZXJjZW50IHNpZ24uXG4gKiBAcGFyYW0ge3N0cmluZ30gcmF0aW5nIC0gUmF0aW5nIHN0cmluZyBmcm9tIGV4dGVybmFsIHNvdXJjZXMuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBOb3JtYWxpemVkIG51bWVyaWMgc3RyaW5nIChlLmcuIFwiNzVcIiwgXCI3LjVcIikuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRSYXRpbmcocmF0aW5nOiBzdHJpbmcpOiBzdHJpbmcge1xuICBsZXQgdmFsdWUgPSByYXRpbmc7XG4gIGNvbnN0IGlzUGVyVGVuID0gcmF0aW5nLmluY2x1ZGVzKFwiLzEwXCIpO1xuICBjb25zdCBpc1BlckNlbnQgPSByYXRpbmcuaW5jbHVkZXMoXCIvMTAwXCIpO1xuXG4gIGlmIChpc1BlclRlbiAmJiAhaXNQZXJDZW50KSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHZhbHVlLnJlcGxhY2UoJywnLCAnLicpO1xuICAgIGNvbnN0IG51bSA9IHBhcnNlRmxvYXQobm9ybWFsaXplZCk7XG4gICAgaWYgKCFpc05hTihudW0pICYmIGlzRmluaXRlKG51bSkpIHtcbiAgICAgIGNvbnN0IG11bHRpcGxpZWQgPSBudW0gKiAxMDtcbiAgICAgIHZhbHVlID0gbXVsdGlwbGllZCAlIDEgPT09IDAgPyBTdHJpbmcoTWF0aC50cnVuYyhtdWx0aXBsaWVkKSkgOiBTdHJpbmcobXVsdGlwbGllZCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJhdGluZy5pbmNsdWRlcyhcIi9cIikgJiYgaXNQZXJDZW50KSB7XG4gICAgdmFsdWUgPSByYXRpbmcuc3BsaXQoXCIvXCIpWzBdLnRyaW0oKTtcbiAgfSBlbHNlIGlmIChyYXRpbmcuaW5jbHVkZXMoXCIlXCIpKSB7XG4gICAgdmFsdWUgPSByYXRpbmcucmVwbGFjZShcIiVcIiwgXCJcIikudHJpbSgpO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG4vKipcbiAqIENvbXB1dGUgdGhlIGF2ZXJhZ2Ugb2YgYW4gYXJyYXkgb2YgcmF0aW5nIHN0cmluZ3MuXG4gKiBVc2VzIGBmb3JtYXRSYXRpbmdgIHRvIG5vcm1hbGl6ZSB2YWx1ZXMsIGlnbm9yZXMgbm9uLW51bWVyaWMgZW50cmllcy5cbiAqIEBwYXJhbSB7c3RyaW5nW119IHJhdGluZ3MgLSBBcnJheSBvZiByYXRpbmcgc3RyaW5ncyB0byBhdmVyYWdlLlxuICogQHJldHVybnMge3N0cmluZ30gQXZlcmFnZSBhcyBhbiBpbnRlZ2VyIHN0cmluZyBvciBvbmUtZGVjaW1hbCBzdHJpbmc7IHJldHVybnMgXCJOL0FcIiBpZiBubyB2YWxpZCByYXRpbmdzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXZlcmFnZVJhdGluZyhyYXRpbmdzOiBzdHJpbmdbXSk6IHN0cmluZyB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRSYXRpbmdzID0gcmF0aW5ncy5tYXAoZm9ybWF0UmF0aW5nKS5tYXAociA9PiBwYXJzZUZsb2F0KHIpKS5maWx0ZXIociA9PiAhaXNOYU4ocikgJiYgaXNGaW5pdGUocikpO1xuICBpZiAobm9ybWFsaXplZFJhdGluZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gXCJOL0FcIjtcbiAgY29uc3Qgc3VtID0gbm9ybWFsaXplZFJhdGluZ3MucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjICsgdmFsLCAwKTtcbiAgY29uc3QgYXZlcmFnZSA9IHN1bSAvIG5vcm1hbGl6ZWRSYXRpbmdzLmxlbmd0aDtcbiAgcmV0dXJuIGF2ZXJhZ2UgJSAxID09PSAwID8gU3RyaW5nKE1hdGgudHJ1bmMoYXZlcmFnZSkpIDogU3RyaW5nKGF2ZXJhZ2UudG9GaXhlZCgxKSk7XG59XG5cbi8qKlxuICogUmVuZGVyIGEgc2ltcGxlIHJhdGluZyBiYXIgVUkgaW50byBhIHBhcmVudCBlbGVtZW50IHVzaW5nIGV4dGVybmFsIHJhdGluZ3MuXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBwYXJlbnQgLSBQYXJlbnQgZWxlbWVudCB0byB3aGljaCB0aGUgcmF0aW5nIGJhciB3aWxsIGJlIGFwcGVuZGVkLlxuICogQHBhcmFtIHtNb3ZpZVJhdGluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbH0gcmF0aW5ncyAtIEFycmF5IG9mIHJhdGluZyBvYmplY3RzIHdpdGggYSBgVmFsdWVgIHByb3BlcnR5LlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIE9wdGlvbmFsIGNsYXNzZXMgdG8gY3VzdG9taXplIGVsZW1lbnRzLlxuICogQHBhcmFtIHt7YmFyQ29udGFpbmVyPzogc3RyaW5nLCBiYXI/OiBzdHJpbmcsIGZpbGw/OiBzdHJpbmcsIGF2ZXJhZ2U/OiBzdHJpbmd9fSBbb3B0aW9ucy5jbGFzc2VzXVxuICogQHJldHVybnMge3tjb250YWluZXI6IEhUTUxFbGVtZW50LCBhdmVyYWdlOiBzdHJpbmcsIHBlcmNlbnRhZ2U6IG51bWJlcn0gfCBudWxsfSBBbiBvYmplY3Qgd2l0aCB0aGUgY29udGFpbmVyIGVsZW1lbnQsIGF2ZXJhZ2Ugc3RyaW5nIGFuZCBwZXJjZW50YWdlIG51bWJlciwgb3IgYG51bGxgIHdoZW4gbm8gcmF0aW5ncyBhcmUgcHJvdmlkZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJFeHRlcm5hbFJhdGluZ0JhcihwYXJlbnQ6IEhUTUxFbGVtZW50LCByYXRpbmdzOiBNb3ZpZVJhdGluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbCwgb3B0aW9ucz86IHtcbiAgY2xhc3Nlcz86IHtcbiAgICBiYXJDb250YWluZXI/OiBzdHJpbmc7XG4gICAgYmFyPzogc3RyaW5nO1xuICAgIGZpbGw/OiBzdHJpbmc7XG4gICAgYXZlcmFnZT86IHN0cmluZztcbiAgfTtcbn0pIHtcbiAgaWYgKCFyYXRpbmdzIHx8IHJhdGluZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICBjb25zdCByYXRpbmdCYXJDb250YWluZXIgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcInBsdWdpbi1yYXRpbmdzLWJhci1jb250YWluZXJcIiB9KTtcbiAgY29uc3QgcmF0aW5nQmFyID0gcmF0aW5nQmFyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJwbHVnaW4tcmF0aW5ncy1iYXJcIiB9KTtcbiAgY29uc3QgcmF0aW5nRmlsbCA9IHJhdGluZ0Jhci5jcmVhdGVEaXYoeyBjbHM6IFwicGx1Z2luLXJhdGluZ3MtZmlsbFwiIH0pO1xuXG4gIGNvbnN0IHZhbHVlcyA9IHJhdGluZ3MubWFwKChyKSA9PiBmb3JtYXRSYXRpbmcoci5WYWx1ZSkpO1xuICBjb25zdCBhdmVyYWdlID0gYXZlcmFnZVJhdGluZyh2YWx1ZXMpO1xuICBjb25zdCBwZXJjZW50YWdlID0gcGFyc2VGbG9hdChhdmVyYWdlKTtcblxuICByYXRpbmdGaWxsLnN0eWxlLndpZHRoID0gYCR7aXNOYU4ocGVyY2VudGFnZSkgPyAwIDogcGVyY2VudGFnZX0lYDtcblxuICByYXRpbmdCYXJDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICB0ZXh0OiBgJHthdmVyYWdlfSVgLFxuICAgIGNsczogXCJwbHVnaW4tcmF0aW5ncy1hdmVyYWdlXCJcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXI6IHJhdGluZ0JhckNvbnRhaW5lcixcbiAgICBhdmVyYWdlLFxuICAgIHBlcmNlbnRhZ2U6IGlzTmFOKHBlcmNlbnRhZ2UpID8gMCA6IHBlcmNlbnRhZ2VcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyBBcHAsIFN1Z2dlc3RNb2RhbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGNsYXNzIEpzb25GaWxlU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFRGaWxlPiB7XG4gIHByaXZhdGUganNvbkZpbGVzOiBURmlsZVtdO1xuICBwcml2YXRlIG9uU2VsZWN0OiAoZmlsZTogVEZpbGUpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoZmlsZTogVEZpbGUpID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMub25TZWxlY3QgPSBvblNlbGVjdDtcbiAgICB0aGlzLmpzb25GaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmKSA9PiBmLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJTZWxlY3QgYSBKU09OIGZpbGUgZnJvbSB5b3VyIHZhdWx0Li4uXCIpO1xuICB9XG5cbiAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFRGaWxlW10ge1xuICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiB0aGlzLmpzb25GaWxlcy5maWx0ZXIoKGZpbGUpID0+XG4gICAgICBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KVxuICAgICk7XG4gIH1cblxuICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGZpbGUucGF0aCB9KTtcbiAgfVxuXG4gIG9uQ2hvb3NlU3VnZ2VzdGlvbihmaWxlOiBURmlsZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgIHRoaXMub25TZWxlY3QoZmlsZSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdERhdGEsIENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgRk9MREVSLCBKU09OX05BTUUgfSBmcm9tIFwic3JjL2NvbnN0YW50c1wiO1xuXG5jb25zdCBERUZBVUxUX05BTUUgPSBgJHtKU09OX05BTUV9Lmpzb25gO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFBhdGgoZm9sZGVyPzogc3RyaW5nKSB7XG4gIGNvbnN0IGZvbGRlclBhdGggPSBmb2xkZXIgPz8gRk9MREVSO1xuICByZXR1cm4gYCR7Zm9sZGVyUGF0aH0vJHtERUZBVUxUX05BTUV9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRlcihmb2xkZXI/OiBzdHJpbmcpIHtcbiAgcmV0dXJuIGZvbGRlciA/PyBGT0xERVI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbXB0eU1vdmllKCk6IENpbmVWYXVsdE1vdmllIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICBpbWRiSWQ6IFwiXCIsXG4gICAgdGl0bGU6IFwiXCIsXG4gICAgeWVhcjogXCJcIixcbiAgICByYXRlZDogXCJcIixcbiAgICByZWxlYXNlZDogXCJcIixcbiAgICBydW50aW1lOiBcIlwiLFxuICAgIGdlbnJlOiBcIlwiLFxuICAgIGRpcmVjdG9yOiBcIlwiLFxuICAgIHdyaXRlcjogXCJcIixcbiAgICBhY3RvcnM6IFwiXCIsXG4gICAgcGxvdDogXCJcIixcbiAgICBsYW5ndWFnZTogXCJcIixcbiAgICBjb3VudHJ5OiBcIlwiLFxuICAgIGF3YXJkczogXCJcIixcbiAgICBwb3N0ZXI6IFwiXCIsXG4gICAgcG9zdGVyTG9jYWw6IFwiXCIsXG4gICAgcmF0aW5nczogW10sXG4gICAgbWV0YXNjb3JlOiBcIlwiLFxuICAgIGltZGJSYXRpbmc6IFwiXCIsXG4gICAgaW1kYlZvdGVzOiBcIlwiLFxuICAgIHR5cGU6IFwiXCIsXG4gICAgZHZkOiBcIlwiLFxuICAgIGJveE9mZmljZTogXCJcIixcbiAgICBwcm9kdWN0aW9uOiBcIlwiLFxuICAgIHdlYnNpdGU6IFwiXCIsXG4gICAgdG90YWxTZWFzb25zOiBcIlwiLFxuICAgIHRvbWF0b1VSTDogXCJcIixcbiAgICB0b21hdG9NZXRlcjogXCJcIixcbiAgICB0b21hdG9JbWFnZTogXCJcIixcbiAgICB0b21hdG9SYXRpbmc6IFwiXCIsXG4gICAgdG9tYXRvUmV2aWV3czogXCJcIixcbiAgICB0b21hdG9GcmVzaDogXCJcIixcbiAgICB0b21hdG9Sb3R0ZW46IFwiXCIsXG4gICAgdG9tYXRvQ29uc2Vuc3VzOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJNZXRlcjogXCJcIixcbiAgICB0b21hdG9Vc2VyUmF0aW5nOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJSZXZpZXdzOiBcIlwiLFxuICAgIHN0YXJSYXRpbmc6IDAsXG4gICAgd2F0Y2hlZDogZmFsc2UsXG4gICAgbm90ZXM6IFwiXCJcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHREYXRhKCk6IENpbmVWYXVsdERhdGEge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIHJldHVybiB7XG4gICAgc2NoZW1hVmVyc2lvbjogMSxcbiAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICB1cGRhdGVkQXQ6IG5vdyxcbiAgICBsaWJyYXJ5TmFtZTogXCJDaW5lVmF1bHRcIixcbiAgICBvd25lcjogXCJcIixcbiAgICBzb3VyY2U6IFwiQ2luZVZhdWx0XCIsXG4gICAgbW92aWVzOiBbXVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplRGF0YShkYXRhOiBDaW5lVmF1bHREYXRhKTogQ2luZVZhdWx0RGF0YSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBtb3ZpZXM6IGRhdGEubW92aWVzLm1hcCgobW92aWUpID0+ICh7XG4gICAgICAuLi5jcmVhdGVFbXB0eU1vdmllKCksXG4gICAgICAuLi5tb3ZpZSxcbiAgICAgIHllYXI6IG1vdmllLnllYXIgPyBTdHJpbmcobW92aWUueWVhcikgOiBcIlwiLFxuICAgICAgc3RhclJhdGluZzogdHlwZW9mIG1vdmllLnN0YXJSYXRpbmcgPT09IFwibnVtYmVyXCIgPyBtb3ZpZS5zdGFyUmF0aW5nIDogMFxuICAgIH0pKVxuICB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRm9sZGVyKGFwcDogQXBwLCBmb2xkZXI/OiBzdHJpbmcpIHtcbiAgY29uc3QgZm9sZGVyUGF0aCA9IGdldEZvbGRlcihmb2xkZXIpO1xuICBpZiAoIWFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCkpIHtcbiAgICBhd2FpdCBhcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVKc29uRmlsZShhcHA6IEFwcCwgZm9sZGVyPzogc3RyaW5nKTogUHJvbWlzZTxURmlsZT4ge1xuICBjb25zdCBmb2xkZXJQYXRoID0gZ2V0Rm9sZGVyKGZvbGRlcik7XG4gIGF3YWl0IGVuc3VyZUZvbGRlcihhcHAsIGZvbGRlcik7XG4gIGNvbnN0IGV4aXN0aW5nID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aChmb2xkZXIpKTtcbiAgY29uc3QgZmlsZW5hbWUgPSBleGlzdGluZyA/IGBib3hvZmZpY2UtJHtEYXRlLm5vdygpfS5qc29uYCA6IERFRkFVTFRfTkFNRTtcbiAgY29uc3QgcGF0aCA9IGAke2ZvbGRlclBhdGh9LyR7ZmlsZW5hbWV9YDtcblxuICByZXR1cm4gYXBwLnZhdWx0LmNyZWF0ZShwYXRoLCBKU09OLnN0cmluZ2lmeShjcmVhdGVEZWZhdWx0RGF0YSgpLCBudWxsLCAyKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTG9jYWxGaWxlKGFwcDogQXBwLCBmaWxlOiBURmlsZSk6IFByb21pc2U8Q2luZVZhdWx0RGF0YT4ge1xuICBjb25zdCByYXcgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcbiAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShyYXcpIGFzIENpbmVWYXVsdERhdGE7XG4gIGlmICghcGFyc2VkIHx8ICFBcnJheS5pc0FycmF5KHBhcnNlZC5tb3ZpZXMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRm9ybWF0byBKU09OIG5vbiB2YWxpZG9cIik7XG4gIH1cbiAgcmV0dXJuIG5vcm1hbGl6ZURhdGEocGFyc2VkKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVMb2NhbERhdGEoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBkYXRhOiBDaW5lVmF1bHREYXRhKSB7XG4gIGF3YWl0IGFwcC52YXVsdC5tb2RpZnkoZmlsZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xufVxuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIHsgQ2luZVZhdWx0U2VhcmNoSXRlbSwgT21kYkRldGFpbGVkUmVzcG9uc2UgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hPbWRiKHF1ZXJ5OiBzdHJpbmcsIGFwaUtleTogc3RyaW5nLCB0eXBlPzogc3RyaW5nLCB5ZWFyPzogc3RyaW5nKTogUHJvbWlzZTxDaW5lVmF1bHRTZWFyY2hJdGVtW10+IHtcbiAgaWYgKCFhcGlLZXkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB0cnkge1xuICAgIGxldCB1cmwgPSBgaHR0cHM6Ly93d3cub21kYmFwaS5jb20vP2FwaWtleT0ke2FwaUtleX0mcz0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YDtcbiAgICBpZiAodHlwZSkge1xuICAgICAgdXJsICs9IGAmdHlwZT0ke2VuY29kZVVSSUNvbXBvbmVudCh0eXBlKX1gO1xuICAgIH1cbiAgICBpZiAoeWVhcikge1xuICAgICAgdXJsICs9IGAmeT0ke2VuY29kZVVSSUNvbXBvbmVudCh5ZWFyKX1gO1xuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwodXJsKTtcbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbiBhcyB7XG4gICAgICBTZWFyY2g/OiBBcnJheTx7IFRpdGxlOiBzdHJpbmc7IFllYXI6IHN0cmluZzsgaW1kYklEOiBzdHJpbmc7IFR5cGU6IHN0cmluZzsgUG9zdGVyOiBzdHJpbmcgfT47XG4gICAgfTtcblxuICAgIGlmIChkYXRhPy5TZWFyY2gpIHtcbiAgICAgIHJldHVybiBkYXRhLlNlYXJjaC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgIGltZGJJZDogaXRlbS5pbWRiSUQsXG4gICAgICAgIHRpdGxlOiBpdGVtLlRpdGxlLFxuICAgICAgICB5ZWFyOiBpdGVtLlllYXIsXG4gICAgICAgIHR5cGU6IGl0ZW0uVHlwZSxcbiAgICAgICAgcG9zdGVyOiBpdGVtLlBvc3RlciAmJiBpdGVtLlBvc3RlciAhPT0gXCJOL0FcIiA/IGl0ZW0uUG9zdGVyIDogXCJcIixcbiAgICAgICAgcGxvdDogXCJcIlxuICAgICAgfSkpO1xuICAgIH1cblxuICAgIHJldHVybiBbXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIE9NRGI6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9tZGJEZXRhaWxzKGltZGJJZDogc3RyaW5nLCBhcGlLZXk6IHN0cmluZywgZGVwdGg6IG51bWJlciA9IDApOiBQcm9taXNlPE9tZGJEZXRhaWxlZFJlc3BvbnNlIHwgbnVsbD4ge1xuICAvLyBSZXRyeSBsaW1pdFxuICBpZiAoZGVwdGggPj0gMykge1xuICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBmZXRjaCBtb3ZpZSBkZXRhaWxzIGFmdGVyICR7ZGVwdGh9IGF0dGVtcHRzYCk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoIWFwaUtleSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cub21kYmFwaS5jb20vP2FwaWtleT0ke2FwaUtleX0maT0ke2ltZGJJZH0mcGxvdD1mdWxsJnRvbWF0b2VzPXRydWVgO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh1cmwpO1xuXG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb24gYXMgT21kYkRldGFpbGVkUmVzcG9uc2UgJiB7IFJlc3BvbnNlOiBzdHJpbmcgfTtcblxuICAgIGlmIChkYXRhLlJlc3BvbnNlICE9PSBcIlRydWVcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIk9NRGIgQVBJIHJldHVybmVkIGVycm9yIHJlc3BvbnNlXCIsIGRhdGEpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIG1vdmllIGRldGFpbHMsIHJldHJ5aW5nLi4uXCIsIGVycm9yKTtcbiAgICByZXR1cm4gZ2V0T21kYkRldGFpbHMoaW1kYklkLCBhcGlLZXksIGRlcHRoICsgMSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBwbHVnaW5WaWV3IGZyb20gXCIuLi92aWV3cy9wbHVnaW5WaWV3XCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0RGF0YSwgY3JlYXRlSnNvbkZpbGUsIGdldERlZmF1bHRQYXRoLCBnZXRGb2xkZXIsIHNhdmVMb2NhbERhdGEgfSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2luZVZhdWx0U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IENpbmVWYXVsdFBsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgLy8gQ29uZmlndXJhdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQ29uZmlndXJhdGlvblwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIk9NRGIgQVBJIGtleVwiKVxuICAgICAgLnNldERlc2MoXCJFbnRlciB5b3VyIE9NRGIgQVBJIGtleS4gWW91IGNhbiBnZXQgb25lIGZvciBmcmVlIGF0IG9tZGJhcGkuY29tXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgeW91ciBBUEkga2V5XCIpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5vbWRiQXBpS2V5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0T21kYkFwaUtleSh2YWx1ZSk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJMaWJyYXJ5IGZvbGRlclwiKVxuICAgICAgLnNldERlc2MoXCJUaGUgZm9sZGVyIHdoZXJlIHRoZSBwbHVnaW4gd2lsbCBzdG9yZSBsaWJyYXJ5IGZpbGVzXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRm9sZGVyIG5hbWVcIilcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBmb2xkZXIgPSB2YWx1ZS50cmltKCkgfHwgXCJCb3hPZmZpY2VcIjtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMaWJyYXJ5Rm9sZGVyKGZvbGRlcik7XG4gICAgICAgIH0pKTtcblxuICAgIC8vIEV4dGVybmFsIGxpYnJhcnkgc3VwcG9ydCByZW1vdmVkLlxuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkxpbmtlZCBsb2NhbCBsaWJyYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcbiAgICAgICAgdGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aFxuICAgICAgICAgID8gYExvY2FsIGZpbGU6ICR7dGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aH1gXG4gICAgICAgICAgOiBcIk5vIGxvY2FsIGxpYnJhcnkgbGlua2VkXCJcbiAgICAgIClcbiAgICAgIC5hZGREcm9wZG93bihkcm9wID0+IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZikgPT4gZi5leHRlbnNpb24gPT09IFwianNvblwiKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgXCJcIjogXCItLSBOb25lIC0tXCIgfTtcbiAgICAgICAgZmlsZXMuZm9yRWFjaCgoZikgPT4gKG9wdGlvbnNbZi5wYXRoXSA9IGYucGF0aCkpO1xuICAgICAgICBkcm9wLmFkZE9wdGlvbnMob3B0aW9ucykuc2V0VmFsdWUodGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aCA/PyBcIlwiKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBwYXRoID0gdmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKHBhdGgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJVbmxpbmsgbG9jYWxcIilcbiAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChudWxsKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hPcGVuVmlld3MoKTtcbiAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkNyZWF0ZSBuZXcgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJDcmVhdGUgYSBuZXcgZW1wdHkgbG9jYWwgbGlicmFyeSBmcm9tIHNjcmF0Y2guIFRoaXMgd2lsbCB1bmxpbmsgYW55IGV4dGVybmFsIGxpYnJhcnkuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDcmVhdGUgbGlicmFyeVwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVOZXdMaWJyYXJ5KCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJFeHBvcnQgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJTYXZlIGEgY29weSBvZiB5b3VyIGxpYnJhcnkgSlNPTiB0byBhIGZpbGUuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJFeHBvcnQgSlNPTlwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5leHBvcnRMaWJyYXJ5SnNvbigpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBCdWdmaXhcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkJ1Z2ZpeFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlcG9ydCBpc3N1ZXNcIilcbiAgICAgIC5zZXREZXNjKFwiSWYgeW91IGVuY291bnRlciBhbnkgaXNzdWVzIHdpdGggdGhlIHBsdWdpbiwgcGxlYXNlIHJlcG9ydCB0aGVtLiBZb3VyIGZlZWRiYWNrIGlzIGludmFsdWFibGUgZm9yIGltcHJvdmluZyBCb3hPZmZpY2UhXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHaXRIdWJcIilcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHdpbmRvdy5vcGVuKFwiaHR0cHM6Ly9naXRodWIuY29tL3ZzY2FwZXJyb3R0YS9vYnNpZGlhbi1jaW5ldmF1bHQvaXNzdWVzXCIsIFwiX2JsYW5rXCIpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBTdXBwb3J0IGFuZCBkb25hdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiU3VwcG9ydFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkRvbmF0ZVwiKVxuICAgICAgLnNldERlc2MoXG4gICAgICAgIFwiSWYgeW91IGxpa2UgdGhpcyBwbHVnaW4sIGNvbnNpZGVyIGRvbmF0aW5nIHRvIHN1cHBvcnQgY29udGludWVkIGRldmVsb3BtZW50LlwiXG4gICAgICApXG4gICAgICAuYWRkQnV0dG9uKChidCkgPT4ge1xuICAgICAgICBidC5idXR0b25FbC5vdXRlckhUTUwgPVxuICAgICAgICAgIFwiPGEgaHJlZj0naHR0cHM6Ly9rby1maS5jb20vVDZUMDFUWDgwNycgdGFyZ2V0PSdfYmxhbmsnPjxpbWcgaGVpZ2h0PSczNicgc3R5bGU9J2JvcmRlcjowcHg7aGVpZ2h0OjM2cHg7JyBzcmM9J2h0dHBzOi8vc3RvcmFnZS5rby1maS5jb20vY2RuL2tvZmk2LnBuZz92PTYnIGJvcmRlcj0nMCcgYWx0PSdCdXkgTWUgYSBDb2ZmZWUgYXQga28tZmkuY29tJyAvPjwvYT5cIjtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRMaWJyYXJ5SnNvbigpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZ2V0TGlicmFyeUpzb25Db250ZW50KCk7XG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgbmV3IE5vdGljZShcIk5vIGxpYnJhcnkgZmlsZSBmb3VuZCB0byBleHBvcnQuXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBleHBvcnQgZmlsZSBpbnNpZGUgdmF1bHQgZm9yIG1vYmlsZSBjb21wYXRpYmlsaXR5XG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCBcIi1cIikuc2xpY2UoMCwgMTkpO1xuICAgICAgY29uc3QgZXhwb3J0UGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS5qc29uYDtcblxuICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMsIGlmIHNvIGFkZCBhIGNvdW50ZXJcbiAgICAgIGxldCBmaW5hbFBhdGggPSBleHBvcnRQYXRoO1xuICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgd2hpbGUgKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaW5hbFBhdGgpKSB7XG4gICAgICAgIGZpbmFsUGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS0ke2NvdW50ZXJ9Lmpzb25gO1xuICAgICAgICBjb3VudGVyKys7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaW5hbFBhdGgsIGNvbnRlbnQpO1xuICAgICAgbmV3IE5vdGljZShgTGlicmFyeSBleHBvcnRlZCB0byAke2ZpbmFsUGF0aH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIltCb3hPZmZpY2VdIEV4cG9ydCBsaWJyYXJ5IGVycm9yXCIsIGVycm9yKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJVbmFibGUgdG8gZXhwb3J0IHRoZSBsaWJyYXJ5LlwiKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0xpYnJhcnkoKSB7XG4gICAgY29uc3QgY29uZmlybWVkID0gd2luZG93LmNvbmZpcm0oXG4gICAgICBcIkNyZWF0ZSBhIG5ldyBlbXB0eSBCb3hPZmZpY2UgbGlicmFyeT8gVGhpcyB3aWxsIHVubGluayBhbnkgZXh0ZXJuYWwgbGlicmFyeSBhbmQgcmVzZXQgeW91ciBsb2NhbCBsaWJyYXJ5IGRhdGEuXCJcbiAgICApO1xuICAgIGlmICghY29uZmlybWVkKSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVmYXVsdEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZ2V0RGVmYXVsdFBhdGgodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcikpO1xuICAgICAgbGV0IGNyZWF0ZWRGaWxlOiBURmlsZSB8IHVuZGVmaW5lZDtcbiAgICAgIGlmIChkZWZhdWx0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5hcHAsIGRlZmF1bHRGaWxlLCBjcmVhdGVEZWZhdWx0RGF0YSgpKTtcbiAgICAgICAgY3JlYXRlZEZpbGUgPSBkZWZhdWx0RmlsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNyZWF0ZWRGaWxlID0gYXdhaXQgY3JlYXRlSnNvbkZpbGUodGhpcy5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3JlYXRlZEZpbGUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChjcmVhdGVkRmlsZS5wYXRoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICBuZXcgTm90aWNlKFwiTmV3IGxpYnJhcnkgY3JlYXRlZC5cIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQm94T2ZmaWNlXSBDcmVhdGUgbmV3IGxpYnJhcnkgZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBjcmVhdGUgYSBuZXcgbGlicmFyeS5cIik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRMaWJyYXJ5SnNvbkNvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gUHJlZmVyIGEgbG9jYWwgbGlua2VkIGZpbGUgaW5zaWRlIHRoZSB2YXVsdFxuICAgIGlmICh0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKSB7XG4gICAgICBjb25zdCBsb2NhbFBhdGggPSB0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoO1xuICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBkZWZhdWx0RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aCh0aGlzLnBsdWdpbi5saWJyYXJ5Rm9sZGVyKSk7XG4gICAgaWYgKGRlZmF1bHRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGRlZmF1bHRGaWxlKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcik7XG4gICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmFwcC52YXVsdFxuICAgICAgLmdldEZpbGVzKClcbiAgICAgIC5maW5kKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoYCR7Zm9sZGVyfS9gKSk7XG5cbiAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGZhbGxiYWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaE9wZW5WaWV3cygpIHtcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRSk7XG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIHBsdWdpblZpZXcpIHtcbiAgICAgICAgYXdhaXQgbGVhZi52aWV3Lm9uT3BlbigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1Qjs7O0FDQ2hCLElBQU0sWUFBWTtBQUNsQixJQUFNLFNBQVM7QUFDZixJQUFNLFlBQVk7QUFDbEIsSUFBTSxhQUFhLENBQUMsU0FBUyxVQUFVLFNBQVM7OztBQ0p2RCxJQUFBQyxtQkFBZ0U7OztBQ0F6RCxTQUFTLGlCQUNkLFdBQ0EsVUFDQSxRQUNBO0FBQ0EsUUFBTSxhQUFhLFVBQVUsVUFBVTtBQUFBLElBQ3JDLEtBQUs7QUFBQSxFQUNQLENBQUM7QUFFRCxRQUFNLFVBQVUsV0FBVyxVQUFVLEVBQUUsS0FBSyxnQ0FBZ0MsQ0FBQztBQUM3RSxRQUFNLGVBQWUsUUFBUSxTQUFTLFVBQVUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzlFLGVBQWEsaUJBQWlCLFNBQVMsUUFBUTtBQUUvQyxNQUFJLFFBQVE7QUFDVixZQUFRLFNBQVMsS0FBSyxFQUFFLE1BQU0sS0FBSyxDQUFDO0FBQ3BDLFVBQU0sYUFBYSxRQUFRLFNBQVMsVUFBVSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDL0UsZUFBVyxpQkFBaUIsU0FBUyxNQUFNO0FBQUEsRUFDN0M7QUFDRjs7O0FDbEJBLHNCQUFzQjtBQUdmLElBQU0sNEJBQU4s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QSxNQUFjLGlCQUFpQjtBQXZDaEM7QUF3Q0UsVUFBTSxPQUFRLE1BQU0sS0FBSyxTQUFTO0FBQ2xDLFNBQUssaUJBQWdCLGtDQUFNLGtCQUFOLFlBQXVCO0FBQzVDLFNBQUssY0FBYSxrQ0FBTSxlQUFOLFlBQW9CO0FBQ3RDLFNBQUssWUFBVyxrQ0FBTSxhQUFOLFlBQWtCO0FBQ2xDLFNBQUssaUJBQWdCLGtDQUFNLGtCQUFOLFlBQXVCO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE1BQU0sY0FBYyxRQUFnQjtBQUNuQyxTQUFLLGFBQWE7QUFDbEIsVUFBTSxLQUFLLGVBQWU7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxZQUFZLFVBQTJCO0FBQzVDLFNBQUssV0FBVztBQUNoQixVQUFNLEtBQUssZUFBZTtBQUFBLEVBQzNCO0FBQUEsRUFFQSxNQUFjLGlCQUFpQjtBQUM5QixVQUFNLE9BQTRCO0FBQUEsTUFDakMsWUFBWSxLQUFLO0FBQUEsTUFDakIsVUFBVSxLQUFLO0FBQUEsTUFDZixlQUFlLEtBQUs7QUFBQSxJQUNyQjtBQUNBLFFBQUksS0FBSyxlQUFlO0FBQ3ZCLFdBQUssZ0JBQWdCLEtBQUs7QUFBQSxJQUMzQjtBQUNBLFVBQU0sS0FBSyxTQUFTLElBQUk7QUFBQSxFQUN6QjtBQUFBLEVBRUEsTUFBTSxpQkFBaUIsTUFBcUI7QUFDM0MsU0FBSyxnQkFBZ0I7QUFDckIsVUFBTSxLQUFLLGVBQWU7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxpQkFBaUIsUUFBZ0I7QUFDdEMsU0FBSyxnQkFBZ0I7QUFDckIsVUFBTSxLQUFLLGVBQWU7QUFBQSxFQUMzQjtBQUFBO0FBQUEsRUFHQSxNQUFjLGFBQWE7QUFDMUIsVUFBTSxpQkFBaUIsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLFNBQVM7QUFDbkUsUUFBSSxlQUFlLFNBQVMsR0FBRztBQUM5QixXQUFLLElBQUksVUFBVSxXQUFXLGVBQWUsQ0FBQyxDQUFDO0FBQy9DO0FBQUEsSUFDRDtBQUVBLFVBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLElBQUk7QUFDNUMsVUFBTSxLQUFLLGFBQWE7QUFBQSxNQUN2QixNQUFNO0FBQUEsTUFDTixRQUFRO0FBQUEsSUFDVCxDQUFDO0FBQUEsRUFDRjtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJ0eXBlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
